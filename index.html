<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµªæ¼«åœ£è¯å¤œ - äº’åŠ¨å°è¯´</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            overflow-x: hidden;
            background: #000;
            position: relative;
        }

        /* é›ªèŠ±èƒŒæ™¯åŠ¨æ•ˆ */
        .snowfall-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .snowflake {
            position: absolute;
            color: white;
            font-size: 1em;
            animation: snowfall linear infinite;
            opacity: 0.8;
        }

        @keyframes snowfall {
            0% {
                transform: translateY(-100vh) translateX(0);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) translateX(100px);
                opacity: 0;
            }
        }

        /* ä¸»ç•Œé¢å®¹å™¨ */
        .novel-container {
            position: relative;
            z-index: 2;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: url('user_input_files/1.png') center/cover no-repeat;
            transition: background-image 0.8s ease-in-out;
        }

        /* æ¸å˜é®ç½© */
        .novel-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                to bottom,
                rgba(40, 10, 10, 0.1) 0%,
                rgba(40, 10, 10, 0.2) 55%,
                rgba(40, 10, 10, 0.5) 100%
            );
            pointer-events: none;
        }

        /* é¡¶éƒ¨ä¿¡æ¯åŒº */
        .header {
            padding: 20px 16px 8px;
            text-align: center;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chapter-title {
            font-family: 'Lora', serif;
            font-size: 22px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 8px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
        }

        .chapter-subtitle {
            font-size: 12px;
            font-weight: 500;
            color: #E0E0E0;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            margin-bottom: 12px;
        }

        /* è¿›åº¦æ¡ */
        .progress-bar {
            width: 120px;
            height: 4px;
            background: #616161;
            border-radius: 2px;
            margin: 0 auto;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #D32F2F, #E57373);
            border-radius: 2px;
            transition: width 600ms cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 0 8px rgba(211, 47, 47, 0.6);
        }

        /* ä¸­å¤®åœºæ™¯å±•ç¤ºåŒº */
        .scene-display {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 16px;
            min-height: 0;
        }

        .scene-content {
            text-align: center;
            max-width: 600px;
        }

        .story-text {
            font-size: 16px;
            line-height: 1.7;
            color: #FFFFFF;
            background: rgba(10, 5, 5, 0.7);
            padding: 20px 24px;
            border-radius: 24px;
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            margin-bottom: 16px;
            transform: scale(0.8);
            animation: storyAppear 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        @keyframes storyAppear {
            to {
                transform: scale(1);
            }
        }

        /* å¯¹è¯åŒºåŸŸ */
        .dialogue-section {
            background: rgba(10, 5, 5, 0.8);
            backdrop-filter: blur(12px);
            padding: 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dialogue-container {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 16px;
            padding-right: 8px;
        }

        .dialogue-container::-webkit-scrollbar {
            width: 4px;
        }

        .dialogue-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        .dialogue-container::-webkit-scrollbar-thumb {
            background: #D32F2F;
            border-radius: 2px;
        }

        .dialogue-bubble {
            margin-bottom: 12px;
            animation: dialogueSlide 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes dialogueSlide {
            from {
                transform: scale(0.8) translateY(10px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        .dialogue-ai {
            text-align: left;
        }

        .dialogue-user {
            text-align: right;
        }

        .dialogue-ai .bubble {
            background: rgba(10, 5, 5, 0.7);
            border-radius: 24px 24px 24px 4px;
        }

        .dialogue-user .bubble {
            background: rgba(46, 125, 50, 0.6);
            border-radius: 24px 24px 4px 24px;
        }

        .bubble {
            display: inline-block;
            padding: 12px 16px;
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 80%;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
        }

        .character-name {
            font-size: 12px;
            font-weight: 500;
            color: #E0E0E0;
            margin-bottom: 4px;
            letter-spacing: 0.05em;
        }

        .dialogue-text {
            font-size: 15px;
            line-height: 1.6;
            color: #FFFFFF;
        }

        /* è¾“å…¥åŒºåŸŸ */
        .input-section {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        /* å¯¹è¯æ¨¡å¼æ‰æ˜¾ç¤ºè¾“å…¥åŒºåŸŸ */
        .input-section.hidden {
            display: none;
        }

        /* çŠ¶æ€æç¤º */
        .status-indicator {
            text-align: center;
            margin: 10px 0;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            display: none;
        }

        .status-indicator.show {
            display: block;
        }

        .status-loading {
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .status-error {
            background: rgba(255, 0, 0, 0.2);
            color: #FF6B6B;
            border: 1px solid rgba(255, 0, 0, 0.3);
        }

        .user-input {
            flex: 1;
            height: 48px;
            padding: 0 16px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(10, 5, 5, 0.7);
            color: #FFFFFF;
            font-size: 16px;
            backdrop-filter: blur(12px);
            transition: all 300ms ease-out;
        }

        .user-input:focus {
            outline: none;
            border: 1.5px solid #E57373;
            box-shadow: 0 0 12px rgba(211, 47, 47, 0.5);
        }

        .user-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        /* æ€è€ƒåŠ¨ç”» */
        .thinking-animation {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: flex-start;
        }

        .dots {
            display: flex;
            gap: 2px;
        }

        .dots span {
            animation: dotBlink 1.4s infinite;
        }

        .dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes dotBlink {
            0%, 20% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
        }

        .send-button {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #D32F2F, #B71C1C);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 250ms ease-out;
            box-shadow: 0 4px 16px rgba(211, 47, 47, 0.4);
        }

        .send-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(211, 47, 47, 0.6);
        }

        .send-button:active {
            transform: scale(0.95);
        }

        /* ç»§ç»­æŒ‰é’® */
        .continue-button {
            position: fixed;
            bottom: 32px;
            right: 24px;
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: linear-gradient(135deg, #D32F2F, #B71C1C);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 250ms ease-out;
            box-shadow: 0 6px 20px rgba(211, 47, 47, 0.6);
            z-index: 10;
        }

        .continue-button:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 24px rgba(211, 47, 47, 0.8);
        }

        .continue-button:active {
            transform: scale(0.95);
        }

        .continue-button.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* é€‰æ‹©ç•Œé¢æ ·å¼ */
        .interaction-choice {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('user_input_files/1.png') center/cover no-repeat;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .interaction-choice::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                135deg,
                rgba(0, 0, 0, 0.85) 0%,
                rgba(0, 0, 0, 0.75) 30%,
                rgba(0, 0, 0, 0.65) 70%,
                rgba(139, 69, 19, 0.4) 100%
            );
            backdrop-filter: blur(2px);
            z-index: -1;
        }

        .choice-container {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 24px;
            padding: 40px 32px;
            max-width: 520px;
            width: 100%;
            text-align: center;
            box-shadow: 
                0 25px 80px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                0 0 40px rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .choice-header {
            margin-bottom: 32px;
        }

        .adrian-portrait {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.4);
            object-fit: cover;
            margin: 0 auto 24px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.4),
                0 0 20px rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .adrian-portrait:hover {
            border-color: rgba(255, 255, 255, 0.6);
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.5),
                0 0 30px rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .main-title {
            font-family: 'Lora', serif;
            font-size: 32px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 8px;
            text-shadow: 
                0 2px 12px rgba(0, 0, 0, 0.8),
                0 0 20px rgba(255, 255, 255, 0.1);
            background: linear-gradient(135deg, #ffffff, #ffb3ba, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 0.5px;
        }

        .choice-title {
            font-family: 'Lora', serif;
            font-size: 28px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 12px;
            text-shadow: 
                0 2px 8px rgba(0, 0, 0, 0.7),
                0 0 20px rgba(255, 255, 255, 0.1);
            background: linear-gradient(135deg, #FFFFFF, #F0F0F0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .choice-subtitle {
            font-size: 18px;
            color: #FFFFFF;
            margin: 0 0 32px 0;
            text-shadow: 
                0 2px 8px rgba(0, 0, 0, 0.8),
                0 0 12px rgba(255, 255, 255, 0.3);
            font-weight: 400;
            line-height: 1.4;
            letter-spacing: 0.3px;
        }

        .choice-options {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .choice-option {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 16px;
            padding: 24px 20px;
            margin: 12px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .choice-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .choice-option:hover::before {
            left: 100%;
        }

        .choice-option:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: #FFD700;
            transform: translateY(-4px);
            box-shadow: 
                0 15px 40px rgba(255, 215, 0, 0.4),
                0 0 30px rgba(255, 215, 0, 0.3),
                0 8px 25px rgba(0, 0, 0, 0.5);
        }

        .choice-option:active {
            transform: translateY(-1px);
        }

        .option-icon {
            font-size: 36px;
            margin-bottom: 12px;
            text-align: center;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
            transition: all 0.3s ease;
        }

        .choice-option:hover .option-icon {
            transform: scale(1.1);
            filter: drop-shadow(0 4px 8px rgba(255, 107, 107, 0.4));
        }

        .option-title {
            font-family: 'Lora', serif;
            font-size: 22px;
            font-weight: 700;
            color: #FFFFFF;
            margin: 0 0 8px 0;
            text-align: center;
            text-shadow: 
                0 2px 8px rgba(0, 0, 0, 0.8),
                0 0 12px rgba(255, 255, 255, 0.3);
            letter-spacing: 0.5px;
        }

        .option-description {
            font-size: 16px;
            color: #F0F0F0;
            margin: 0;
            line-height: 1.5;
            text-shadow: 
                0 2px 6px rgba(0, 0, 0, 0.7),
                0 0 8px rgba(255, 255, 255, 0.2);
            font-weight: 300;
        }

        /* é€‰é¡¹æŒ‰é’®æ ·å¼ */
        .option-button {
            background: rgba(255, 255, 255, 0.25);
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            padding: 16px 20px;
            margin: 8px 0;
            color: #FFFFFF !important;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
            text-align: left;
            backdrop-filter: blur(8px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .option-button:hover {
            background: rgba(255, 215, 0, 0.3);
            border-color: #FFD700;
            transform: translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(255, 215, 0, 0.4),
                0 0 20px rgba(255, 215, 0, 0.3),
                0 6px 20px rgba(0, 0, 0, 0.4);
        }

        .option-button:active {
            transform: translateY(0);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (min-width: 768px) {
            .novel-container {
                max-width: 640px;
                margin: 0 auto;
            }
        }

        /* å‡å°‘åŠ¨ç”»é€‚é… */
        @media (prefers-reduced-motion: reduce) {
            .snowflake {
                animation: none;
            }
            
            .story-text,
            .dialogue-bubble {
                animation: none;
            }
        }
    </style>
</head>
<body>
    <!-- é›ªèŠ±èƒŒæ™¯ -->
    <div class="snowfall-container" id="snowfallContainer"></div>

    <!-- é€‰æ‹©äº’åŠ¨æ–¹å¼ç•Œé¢ -->
    <div class="interaction-choice" id="interactionChoice">
        <div class="choice-container">
            <div class="choice-header">
                <img src="user_input_files/adrian_character.png" alt="è‰¾å¾·é‡Œå®‰" class="adrian-portrait">
                <h1 class="main-title">å¹³è¡Œå®‡å®™Â· å’Œè‰¾å¾·é‡Œå®‰çš„åœ£è¯æ—¥</h1>
                <h2 class="choice-title">é€‰æ‹©ä½ çš„äº’åŠ¨æ–¹å¼</h2>
                <p class="choice-subtitle">å¦‚ä½•ä¸è‰¾å¾·é‡Œå®‰å¼€å§‹ä½ çš„æµªæ¼«åœ£è¯ä¹‹æ—…ï¼Ÿ</p>
            </div>
            
            <div class="choice-options">
                <div class="choice-option" id="dialogueChoice">
                    <div class="option-icon">ğŸ’¬</div>
                    <h3 class="option-title">è‡ªç”±å¯¹è¯</h3>
                    <p class="option-description">é€šè¿‡æ–‡å­—ä¸è‰¾å¾·é‡Œå®‰è‡ªç”±äº¤æµï¼Œè¡¨è¾¾ä½ çš„æƒ³æ³•å’Œæ„Ÿå—</p>
                </div>
                
                <div class="choice-option" id="optionChoice">
                    <div class="option-icon">ğŸ¯</div>
                    <h3 class="option-title">é€‰æ‹©äº’åŠ¨</h3>
                    <p class="option-description">é€šè¿‡é€‰æ‹©é¢˜ä¸è‰¾å¾·é‡Œå®‰äº’åŠ¨ï¼Œæ¯ä¸ªé€‰æ‹©éƒ½ä¼šå¸¦æ¥ä¸åŒçš„å¯¹è¯ä½“éªŒ</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¸»ç•Œé¢ -->
    <div class="novel-container" id="novelContainer">
        <!-- é¡¶éƒ¨ä¿¡æ¯ -->
        <header class="header">
            <h1 class="chapter-title" id="chapterTitle">ç¬¬ä¸€ç« ï¼šæ„å¤–ç©¿è¶Š</h1>
            <p class="chapter-subtitle" id="chapterSubtitle">æ¸©æš–åœ£è¯å¤œ</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 8.33%"></div>
            </div>
        </header>

        <!-- ä¸­å¤®åœºæ™¯å±•ç¤º -->
        <main class="scene-display">
            <div class="scene-content">
                <div class="story-text" id="storyText">
                    é›ªèŠ±çº·é£çš„å¤œæ™šï¼Œä½ æ„Ÿåˆ°ä¸€é˜µçœ©æ™•ã€‚å½“è§†çº¿é‡æ–°æ¸…æ™°æ—¶ï¼Œé¢å‰æ˜¯ä¸€ä¸ªå®Œå…¨ä¸åŒçš„ä¸–ç•Œâ€”â€”ä¸€ä¸ªå……æ»¡åœ£è¯é­”æ³•çš„æ¬§æ´²å°é•‡ã€‚èº«è¾¹ç«™ç€ä¸€ä½è‹±ä¿Šçš„ç”·å£«ï¼Œä»–æ­£æ¸©æŸ”åœ°çœ‹ç€ä½ ï¼Œçœ¼ä¸­æ»¡å«æƒŠå–œ...
                </div>
            </div>
        </main>

        <!-- å¯¹è¯å’Œè¾“å…¥åŒºåŸŸ -->
        <section class="dialogue-section">
            <!-- çŠ¶æ€æŒ‡ç¤ºå™¨ -->
            <div class="status-indicator" id="statusIndicator"></div>
            
            <div class="dialogue-container" id="dialogueContainer">
                <!-- å¯¹è¯å†…å®¹å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
            </div>
            
            <div class="input-section" id="inputSection">
                <input 
                    type="text" 
                    class="user-input" 
                    id="userInput"
                    placeholder="ä½œä¸ºå¥³ä¸»è§’è¾“å…¥ä½ çš„å›åº”..."
                    maxlength="200"
                >
                <button class="send-button" id="sendButton">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
        </section>
    </div>

    <!-- ç»§ç»­æŒ‰é’® -->
    <button class="continue-button" id="continueButton">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </button>

    <script>
        // MiniMax APIé…ç½®
        const MINIMAX_CONFIG = {
            API_URL: 'https://api.minimaxi.com/v1/text/chatcompletion_v2',
            API_KEY: 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJHcm91cE5hbWUiOiLmnajnvo7njokiLCJVc2VyTmFtZSI6IuadqOe-jueOiSIsIkFjY291bnQiOiIiLCJTdWJqZWN0SUQiOiIxODgxMjAxNTI0ODk0MzUxMzg4IiwiUGhvbmUiOiIxNzYwMDIyMTg0NCIsIkdyb3VwSUQiOiIxODgxMjAxNTI0ODg1OTYyNzgwIiwiUGFnZU5hbWUiOiIiLCJNYWlsIjoiIiwiQ3JlYXRlVGltZSI6IjIwMjUtMTAtMzAgMTc6NTI6MDkiLCJUb2tlblR5cGUiOjEsImlzcyI6Im1pbmltYXgifQ.hEnEbgXveTGstkieIl2YLFh_JfQHMrnIrmy2LoLbai7pVb3ktNDXDG3yUZhF26mZ-GW0eQfcviSyaZ7-Ox-UZvWH23N0PmbjrjyN9wY4Kawyee9BXRetLffiuhEx5NEXOqgNgyEO4s83aI9nvwe_vA8RUY8L5bSJcnR042NReKWBSQXGxI23bpYw7Y_LHJKg3ia-dogib8ehKVEzuSVIcEiYezAzHxItvqzcwS88XrXYOW60N8SBO9QR3l0T8XHo-CfDzBRVeoEpYphwVbnLsugcXyxZly1zoenS4wLkLdyU_JahG-zLQFB5KvD3Sp9VCN68TZUcowbrxRlhaFhBA',
            MODEL: 'abab6.5s-chat'
        };

        let conversationHistory = []; // å¯¹è¯å†å²ï¼Œç”¨äºè‡ªç”±å¯¹è¯æ¨¡å¼

        // ç« èŠ‚æ•°æ®
        const chapters = [
            {
                id: 1,
                title: "ç¬¬ä¸€ç« ï¼šæ„å¤–ç©¿è¶Š",
                subtitle: "æ¸©æš–åœ£è¯å¤œ",
                background: "user_input_files/1.png",
                story: "é›ªèŠ±çº·é£çš„å¤œæ™šï¼Œä½ æ„Ÿåˆ°ä¸€é˜µçœ©æ™•ã€‚å½“è§†çº¿é‡æ–°æ¸…æ™°æ—¶ï¼Œé¢å‰æ˜¯ä¸€ä¸ªå®Œå…¨ä¸åŒçš„ä¸–ç•Œâ€”â€”ä¸€ä¸ªå……æ»¡åœ£è¯é­”æ³•çš„æ¬§æ´²å°é•‡ã€‚èº«è¾¹ç«™ç€ä¸€ä½è‹±ä¿Šçš„ç”·å£«ï¼Œä»–æ­£æ¸©æŸ”åœ°çœ‹ç€ä½ ï¼Œçœ¼ä¸­æ»¡å«æƒŠå–œ...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "äº²çˆ±çš„ï¼Œä½ è¿˜å¥½å—ï¼Ÿæˆ‘æ˜¯æ–°æ¥çš„å—ï¼Ÿçœ‹èµ·æ¥ä½ å’Œæˆ‘ä¸€æ ·ï¼Œå¯¹è¿™é‡Œæ„Ÿåˆ°é™Œç”Ÿã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "è¿™é‡Œä¼¼ä¹æ˜¯ä¸€ä¸ªåœ£è¯å°é•‡...å¾ˆç¾ï¼Œä¸æ˜¯å—ï¼Ÿä¹Ÿè®¸æ˜¯æŸç§é­”æ³•è®©æˆ‘ä»¬æ¥åˆ°äº†è¿™é‡Œã€‚" }
                ]
            },
            {
                id: 2,
                title: "ç¬¬äºŒç« ï¼šåœ£è¯é›†å¸‚åˆä½“éªŒ",
                subtitle: "æ¸©æš–çƒ­çº¢é…’",
                background: "user_input_files/2.png",
                story: "ä½ ä»¬ä¸€åŒèµ°å‘ç¯ç«é€šæ˜çš„åœ£è¯å¸‚é›†ã€‚ç©ºæ°”ä¸­å¼¥æ¼«ç€é¦™æ–™å’Œçƒ­çº¢é…’çš„é¦™æ°”ï¼Œæ‘Šä½ä¸Šæ‘†æ»¡äº†ç²¾ç¾çš„æ‰‹å·¥è‰ºå“å’ŒèŠ‚æ—¥è£…é¥°ã€‚è‰¾å¾·é‡Œå®‰æ¸©æŸ”åœ°ä¸ºä½ é€’ä¸Šä¸€æ¯å†’ç€çƒ­æ°”çš„çº¢é…’...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "æ¥ï¼Œè¯•è¯•è¿™ä¸ªçƒ­çº¢é…’ã€‚æˆ‘ä»¬ä¸€èµ·æ¸©æš–ä¸€ä¸‹èº«å¿ƒã€‚è¿™é¦™æ–™çš„å‘³é“çœŸçš„å¾ˆæ£’ã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "åœ¨è¿™æ ·çš„å¤œæ™šï¼Œæœ‰ä½ åœ¨èº«è¾¹ï¼Œæ„Ÿè§‰ç‰¹åˆ«æ¸©æš–ã€‚ç‰¹åˆ«æ˜¯åœ¨è¿™ä¸ªç¥å¥‡çš„å°é•‡ä¸Šã€‚" }
                ]
            },
            {
                id: 3,
                title: "ç¬¬ä¸‰ç« ï¼šç¾å¥½ç¬é—´",
                subtitle: "åœ£è¯æ ‘ä¸‹çš„åˆå½±",
                background: "user_input_files/3.png",
                story: "å·¨å¤§çš„åœ£è¯æ ‘ä¸‹ï¼Œè‰¾å¾·é‡Œå®‰ä¸¾èµ·æ‰‹æœºï¼Œæƒ³è¦ä¸ºè¿™ä¸ªç‰¹åˆ«çš„æ—¶åˆ»ç•™ä¸‹ç¾å¥½çš„å›å¿†ã€‚å½©ç¯é—ªçƒï¼Œé›ªèŠ±é£˜èˆï¼Œè¿™ä¸€åˆ»å¦‚åŒç«¥è¯èˆ¬æ¢¦å¹»...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "æ¥ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œæ‹å¼ ç…§ç‰‡å§ã€‚è¿™æ£µåœ£è¯æ ‘å¤ªç¾äº†ï¼Œæˆ‘ä»¬ä¸èƒ½è®©è¿™ä¸ªç¬é—´æºœèµ°ã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "ä½ ç¬‘å¾—å¾ˆç¾...è¿™ä¸ªä¸–ç•Œä¸Šï¼Œå†æ²¡æœ‰æ¯”æ­¤åˆ»æ›´ç¾å¥½çš„ç”»é¢äº†ã€‚" }
                ]
            },
            {
                id: 4,
                title: "ç¬¬å››ç« ï¼šæ—‹è½¬æœ¨é©¬",
                subtitle: "ç«¥çœŸä¸æµªæ¼«",
                background: "user_input_files/4.png",
                story: "åä¸½çš„æ—‹è½¬æœ¨é©¬åœ¨ç¯å…‰ä¸­ç¼“ç¼“è½¬åŠ¨ï¼Œç«¥è¯èˆ¬çš„éŸ³ä¹å“èµ·ã€‚è‰¾å¾·é‡Œå®‰ç‰µèµ·ä½ çš„æ‰‹ï¼Œä¸€èµ·åä¸Šäº†è¿™å……æ»¡é­”æ³•çš„æœ¨é©¬ï¼Œæ„Ÿå—ç€ç«¥çœŸä¸æµªæ¼«çš„äº¤ç»‡...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "å°æ—¶å€™æˆ‘å°±æ¢¦æƒ³ç€èƒ½å’Œä¸€ä¸ªç‰¹åˆ«çš„äººä¸€èµ·åæ—‹è½¬æœ¨é©¬ã€‚ç°åœ¨ï¼Œè¿™ä¸ªæ¢¦æƒ³å®ç°äº†ã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "ä½ æ„¿æ„å’Œæˆ‘ä¸€èµ·å›åˆ°é‚£ä¸ªå……æ»¡ç«¥è¯çš„ä¸–ç•Œå—ï¼Ÿåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å¿˜è®°ä¸€åˆ‡çƒ¦æ¼ã€‚" }
                ]
            },
            {
                id: 5,
                title: "ç¬¬äº”ç« ï¼šæ¬¢ä¹æ—¶å…‰",
                subtitle: "æœ¨é©¬å‰çš„è‡ªæ‹",
                background: "user_input_files/5.png",
                story: "æœ¨é©¬å‰çš„ç¯å…‰é—ªçƒï¼Œè‰¾å¾·é‡Œå®‰å…´å¥‹åœ°æ‹‰ç€ä½ ä¸€èµ·è‡ªæ‹ã€‚ä½ ä»¬çš„ç¬‘å®¹åœ¨é•œå¤´ä¸­é—ªé—ªå‘å…‰ï¼Œå¦‚åŒå¤œç©ºä¸­æœ€äº®çš„æ˜Ÿæ˜Ÿ...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "å†æ¥ä¸€å¼ è‡ªæ‹ï¼è¿™ä¸ªè§’åº¦çš„ä½ å¤ªç¾äº†ï¼Œæˆ‘æƒ³æŠŠè¿™äº›ç¾å¥½çš„ç¬é—´éƒ½ä¿å­˜ä¸‹æ¥ã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "å’Œä½ åœ¨ä¸€èµ·çš„æ¯ä¸€åˆ»ï¼Œéƒ½å€¼å¾—è¢«è®°å½•ä¸‹æ¥ã€‚è¿™æ˜¯æˆ‘ä»¬ä¸“å±çš„å›å¿†ã€‚" }
                ]
            },
            {
                id: 6,
                title: "ç¬¬å…­ç« ï¼šå¿ƒåŠ¨æ—¶åˆ»",
                subtitle: "æ·±æƒ…ä¸€å»",
                background: "user_input_files/6.png",
                story: "åœ¨æ—‹è½¬æœ¨é©¬çš„ç’€ç’¨ç¯å…‰ä¸‹ï¼Œä½ ä»¬å››ç›®ç›¸å¯¹ã€‚æ—¶é—´ä»¿ä½›é™æ­¢äº†ï¼Œå¿ƒè·³å£°æ¸…æ™°å¯é—»ã€‚è‰¾å¾·é‡Œå®‰ç¼“ç¼“é è¿‘ï¼Œç»™äº†ä½ ä¸€ä¸ªæ¸©æŸ”è€Œæ·±æƒ…çš„å»...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "ä½ çŸ¥é“å—ï¼Ÿä»è§åˆ°ä½ çš„ç¬¬ä¸€çœ¼èµ·ï¼Œæˆ‘å°±çŸ¥é“ä½ æ˜¯é‚£ä¸ªç‰¹åˆ«çš„äººã€‚ç°åœ¨ï¼Œæˆ‘ç»ˆäºå¯ä»¥å‘Šè¯‰ä½ ..." },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "æˆ‘çˆ±ä½ ã€‚ä¸æ˜¯åœ¨è¿™ä¸ªé­”æ³•å°é•‡ï¼Œè€Œæ˜¯ä»å¿ƒåº•æ·±å¤„çš„çˆ±ã€‚è¿™ä¸ªå»ï¼Œæ˜¯æˆ‘å¯¹ä½ çš„æ‰¿è¯ºã€‚" }
                ]
            },
            {
                id: 7,
                title: "ç¬¬ä¸ƒç« ï¼šçƒ›å…‰æ™šé¤",
                subtitle: "æµªæ¼«ç”¨é¤æ—¶å…‰",
                background: "user_input_files/7.png",
                story: "æ¸©æš–çš„å£ç‚‰æ—ï¼Œä½ ä»¬äº«ç”¨ç€ç²¾è‡´çš„åœ£è¯æ™šé¤ã€‚çƒ›å…‰æ‘‡æ›³ï¼Œçº¢é…’é£˜é¦™ï¼Œè¿™ä¸€åˆ»çš„æ¸©é¦¨ä¸æµªæ¼«è®©äººé™¶é†‰...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "è¿™é¡¿æ™šé¤å¸Œæœ›ä½ ä¼šå–œæ¬¢ã€‚æˆ‘ç‰¹æ„é€‰äº†è¿™ä¸ªæœ€æµªæ¼«çš„ä½ç½®ï¼Œæƒ³å’Œä½ å…±åº¦è¿™ä¸ªç‰¹åˆ«çš„å¤œæ™šã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "çœ‹ç€ä½ ç”¨é¤çš„æ ·å­ï¼Œæˆ‘è§‰å¾—è‡ªå·±æ˜¯æœ€å¹¸ç¦çš„äººã€‚å¸Œæœ›æ¯ä¸€å¤©éƒ½èƒ½è¿™æ ·é™ªä¼´ç€ä½ ã€‚" }
                ]
            },
            {
                id: 8,
                title: "ç¬¬å…«ç« ï¼šæƒŠå–œç¤¼ç‰©",
                subtitle: "çˆ±çš„é¦ˆèµ ",
                background: "user_input_files/8.png",
                story: "æ™šé¤è¿›è¡Œåˆ°ä¸€åŠæ—¶ï¼Œè‰¾å¾·é‡Œå®‰ç¥ç§˜åœ°ä»èº«åæ‹¿å‡ºä¸€ä¸ªç²¾ç¾çš„ç¤¼ç‰©ç›’ã€‚çº¢è‰²çš„åŒ…è£…çº¸åœ¨çƒ›å…‰ä¸‹é—ªé—ªå‘å…‰ï¼Œä¸Šé¢ç³»ç€é‡‘è‰²çš„ä¸å¸¦...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "æˆ‘æƒ³ä¸ºä½ å‡†å¤‡ä¸€ä¸ªç‰¹åˆ«çš„ç¤¼ç‰©ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç‰©å“ï¼Œè€Œæ˜¯æˆ‘å¯¹ä½ æ„Ÿæƒ…çš„è¡¨è¾¾ã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "æ‰“å¼€å®ƒçš„æ—¶å€™ï¼Œå¸Œæœ›ä½ ä¼šå–œæ¬¢ã€‚è¿™æ˜¯æˆ‘ç²¾å¿ƒä¸ºä½ æŒ‘é€‰çš„ï¼Œä»£è¡¨ç€æˆ‘å¯¹ä½ çš„çˆ±æ„ã€‚" }
                ]
            },
            {
                id: 9,
                title: "ç¬¬ä¹ç« ï¼šæ‹†ç¤¼ç‰©æƒŠå–œ",
                subtitle: "ç”œèœœçš„æƒŠå–œ",
                background: "user_input_files/9.png",
                story: "ä½ å°å¿ƒç¿¼ç¿¼åœ°æ‰“å¼€ç¤¼ç‰©ç›’ï¼Œé‡Œé¢æ˜¯ä¸€æ¡ç²¾ç¾çš„é¡¹é“¾ï¼Œåœ¨çƒ›å…‰ä¸‹æ•£å‘ç€æ¸©æŸ”çš„å…‰èŠ’ã€‚æ›´ä»¤ä½ æƒŠå–œçš„æ˜¯ï¼Œç¤¼ç‰©ç›’ä¸­è¿˜æ”¾ç€ä¸€å¼ å†™ç€çˆ±æ„çš„å°å¡ç‰‡...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "å¸Œæœ›ä½ ä¼šå–œæ¬¢è¿™æ¡é¡¹é“¾ã€‚å°±åƒæˆ‘è¯´çš„ï¼Œå®ƒä»£è¡¨ç€æˆ‘å¯¹ä½ çš„çˆ±æ„å’Œæ‰¿è¯ºã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "çœ‹åˆ°ä½ å¼€å¿ƒçš„æ ·å­ï¼Œæˆ‘è§‰å¾—æ‰€æœ‰çš„å‡†å¤‡éƒ½æ˜¯å€¼å¾—çš„ã€‚ä½ å°±æ˜¯æˆ‘çš„æ•´ä¸ªä¸–ç•Œã€‚" }
                ]
            },
            {
                id: 10,
                title: "ç¬¬åç« ï¼šå †é›ªäºº",
                subtitle: "ç«¥è¶£æ—¶å…‰",
                background: "user_input_files/10.png",
                story: "æ™šé¤åï¼Œä½ ä»¬æ¥åˆ°äº†é›ªåçš„åº­é™¢ã€‚æœˆå…‰æ´’åœ¨é›ªåœ°ä¸Šï¼Œä¸€åˆ‡éƒ½æ˜¾å¾—é‚£ä¹ˆå®é™ç¾å¥½ã€‚è‰¾å¾·é‡Œå®‰æè®®ä¸€èµ·å †ä¸€ä¸ªé›ªäººï¼Œä½ ä»¬å¼€å§‹åŠ¨æ‰‹...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·å †ä¸ªé›ªäººï¼å°æ—¶å€™æˆ‘å¾ˆå–œæ¬¢å †é›ªäººï¼Œç°åœ¨æƒ³å’Œä½ ä¸€èµ·é‡æ¸©é‚£ä»½ç«¥çœŸã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "è¿™ä¸ªé›ªäººå°±åƒæˆ‘ä»¬ä¸€æ ·ï¼Œç»å†äº†é›ªçš„æ´—ç¤¼åï¼Œå˜å¾—æ›´åŠ ç¾ä¸½å’Œåšå›ºã€‚" }
                ]
            },
            {
                id: 11,
                title: "ç¬¬åä¸€ç« ï¼šé›ªäººè£…é¥°",
                subtitle: "å®Œç¾çš„ç‚¹ç¼€",
                background: "user_input_files/11.png",
                story: "é›ªäººçš„èº«ä½“å †å¥½äº†ï¼Œè‰¾å¾·é‡Œå®‰ä»æ€€é‡Œæ‹¿å‡ºä¸€é¡¶é»‘è‰²çš„ç¤¼å¸½ï¼Œè½»æŸ”åœ°æˆ´åœ¨é›ªäººçš„å¤´ä¸Šã€‚è¿™ä¸ªå°ç»†èŠ‚è®©æ•´ä¸ªé›ªäººç¬é—´å˜å¾—æ›´åŠ ç”ŸåŠ¨æœ‰è¶£...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "ä½ çœ‹ï¼Œæˆ´ä¸Šè¿™é¡¶å¸½å­ï¼Œæˆ‘ä»¬çš„é›ªäººæ˜¯ä¸æ˜¯æ›´æœ‰æ°”è´¨äº†ï¼Ÿå®ƒç°åœ¨å°±åƒä¸ªçœŸæ­£çš„ç»…å£«ã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "å°±åƒä½ ç»™æˆ‘å¸¦æ¥çš„æ”¹å˜ä¸€æ ·ï¼Œè®©æˆ‘çš„ç”Ÿæ´»å˜å¾—æ›´åŠ å®Œç¾å’Œæœ‰æ„ä¹‰ã€‚" }
                ]
            },
            {
                id: 12,
                title: "ç¬¬åäºŒç« ï¼šé›ªä¸­èµ·èˆ",
                subtitle: "æ°¸æ’çš„çˆ±",
                background: "user_input_files/12.png",
                story: "é›ªèŠ±å†æ¬¡é£˜è½ï¼Œä½ ä»¬æ‰‹ç‰µç€æ‰‹åœ¨åº­é™¢ä¸­ç¿©ç¿©èµ·èˆã€‚æ²¡æœ‰éŸ³ä¹ï¼Œä½†ä½ ä»¬çš„å¿ƒè·³å°±æ˜¯æœ€ç¾çš„èŠ‚æ‹ã€‚è¿™ä¸ªåœ£è¯å¤œï¼Œå°†æˆä¸ºä½ ä»¬ä¸€ç”Ÿä¸­æœ€ç¾å¥½çš„å›å¿†...",
                aiIntro: [
                    { character: "è‰¾å¾·é‡Œå®‰", text: "è°¢è°¢ä½ é™ªæˆ‘åº¦è¿‡è¿™ä¸ªæœ€ç¾å¥½çš„åœ£è¯å¤œã€‚æ— è®ºè¿™æ˜¯æ¢¦å¢ƒè¿˜æ˜¯ç°å®ï¼Œä½ éƒ½æ˜¯æˆ‘æ­¤ç”Ÿæœ€çè´µçš„äººã€‚" },
                    { character: "è‰¾å¾·é‡Œå®‰", text: "æˆ‘ä»¬çš„æ•…äº‹æ‰åˆšåˆšå¼€å§‹ã€‚è®©æˆ‘ç”¨ä¸€ç”Ÿçš„æ—¶é—´ï¼Œæ¥çˆ±ä½ ï¼Œå®ˆæŠ¤ä½ ã€‚è¿™æ˜¯æˆ‘å¯¹ä½ çš„æ‰¿è¯ºã€‚" }
                ]
            }
        ];

        // å½“å‰ç« èŠ‚ç´¢å¼•
        let currentChapterIndex = 0;
        let dialogueStarted = false;
        let initialDialogue = true;  // ç”¨äºæ§åˆ¶é¦–æ¬¡å¯¹è¯
        let interactionMode = null;  // 'dialogue' æˆ– 'options'
        let currentQuestionIndex = 0;  // é€‰é¡¹æ¨¡å¼å½“å‰é—®é¢˜ç´¢å¼•
        let optionQuestions = {};  // å­˜å‚¨æ¯ä¸ªç« èŠ‚çš„é€‰é¡¹é—®é¢˜

        // åˆå§‹åŒ–
        function init() {
            console.log('ğŸš€ å¼€å§‹åˆå§‹åŒ–åº”ç”¨...');
            
            try {
                console.log('â„ï¸ åˆ›å»ºé›ªèŠ±æ•ˆæœ...');
                createSnowflakes();
                
                console.log('ğŸ”— ç»‘å®šé€‰æ‹©ç•Œé¢äº‹ä»¶...');
                bindChoiceEvents();
                
                console.log('ğŸ”— ç»‘å®šä¸»ç•Œé¢äº‹ä»¶...');
                bindEvents();
                
                console.log('âœ… åº”ç”¨åˆå§‹åŒ–å®Œæˆ');
                // ä¸è‡ªåŠ¨å¼€å§‹å¯¹è¯ï¼Œç­‰å¾…ç”¨æˆ·é€‰æ‹©äº’åŠ¨æ–¹å¼
            } catch (error) {
                console.error('âŒ åˆå§‹åŒ–è¿‡ç¨‹å‡ºé”™:', error);
            }
        }

        // åˆ›å»ºé›ªèŠ±æ•ˆæœ
        function createSnowflakes() {
            const container = document.getElementById('snowfallContainer');
            const snowflakeCount = 50;

            for (let i = 0; i < snowflakeCount; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                snowflake.innerHTML = 'â„';
                snowflake.style.left = Math.random() * 100 + '%';
                snowflake.style.animationDuration = (Math.random() * 3 + 2) + 's';
                snowflake.style.animationDelay = Math.random() * 2 + 's';
                snowflake.style.opacity = Math.random() * 0.5 + 0.3;
                container.appendChild(snowflake);
            }
        }

        // æ›´æ–°ç« èŠ‚
        function updateChapter() {
            const chapter = chapters[currentChapterIndex];
            
            // æ›´æ–°èƒŒæ™¯
            const container = document.getElementById('novelContainer');
            container.style.backgroundImage = `url('${chapter.background}')`;
            
            // æ›´æ–°æ ‡é¢˜
            document.getElementById('chapterTitle').textContent = chapter.title;
            document.getElementById('chapterSubtitle').textContent = chapter.subtitle;
            
            // æ›´æ–°æ•…äº‹æ–‡æœ¬ï¼ˆå¼€åœºç™½ï¼‰
            const storyText = document.getElementById('storyText');
            storyText.style.opacity = '0';
            setTimeout(() => {
                storyText.textContent = chapter.story;
                storyText.style.display = 'block';
                storyText.style.opacity = '1';
            }, 300);
            
            // æ›´æ–°è¿›åº¦æ¡
            const progress = ((currentChapterIndex + 1) / chapters.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // æ¸…ç©ºå¯¹è¯å¹¶é‡ç½®çŠ¶æ€
            document.getElementById('dialogueContainer').innerHTML = '';
            dialogueStarted = false;
            initialDialogue = true;
            currentQuestionIndex = 0;
            
            // éšè—çŠ¶æ€æç¤ºå’Œæ€è€ƒåŠ¨ç”»
            hideStatus();
            hideThinking();
            
            // å¦‚æœæ˜¯å¯¹è¯æ¨¡å¼ï¼Œé‡ç½®å¯¹è¯å†å²
            if (interactionMode === 'dialogue') {
                conversationHistory = [];
            }
            
            // æ˜¾ç¤ºç»§ç»­æŒ‰é’®
            document.getElementById('continueButton').classList.remove('hidden');
        }

        // å¼€å§‹å¯¹è¯
        function startDialogue() {
            if (dialogueStarted || interactionMode !== 'dialogue') return;
            
            dialogueStarted = true;
            const chapter = chapters[currentChapterIndex];
            const container = document.getElementById('dialogueContainer');
            
            // éšè—å¼€åœºç™½
            const storyText = document.getElementById('storyText');
            storyText.style.opacity = '0';
            
            // éšè—ç»§ç»­æŒ‰é’®
            document.getElementById('continueButton').classList.add('hidden');
            
            // æ·»åŠ AIä»‹ç»å¯¹è¯
            setTimeout(() => {
                chapter.aiIntro.forEach((line, index) => {
                    setTimeout(() => {
                        addDialogue('è‰¾å¾·é‡Œå®‰', line.text);
                    }, index * 1500);
                });
            }, 1000);
        }

        // æ·»åŠ å¯¹è¯ï¼ˆå•æ¡æ˜¾ç¤ºï¼‰
        function addDialogue(character, text, isUser = false) {
            const container = document.getElementById('dialogueContainer');
            // æ¸…ç©ºä¹‹å‰çš„å¯¹è¯ï¼Œåªæ˜¾ç¤ºå½“å‰ä¸€æ¡
            container.innerHTML = '';
            
            const dialogueDiv = document.createElement('div');
            dialogueDiv.className = `dialogue-bubble ${isUser ? 'dialogue-user' : 'dialogue-ai'}`;
            
            const nameDiv = document.createElement('div');
            nameDiv.className = 'character-name';
            nameDiv.textContent = character;
            
            const bubbleDiv = document.createElement('div');
            bubbleDiv.className = 'bubble';
            
            const textDiv = document.createElement('div');
            textDiv.className = 'dialogue-text';
            textDiv.textContent = text;
            
            bubbleDiv.appendChild(textDiv);
            dialogueDiv.appendChild(nameDiv);
            dialogueDiv.appendChild(bubbleDiv);
            
            container.appendChild(dialogueDiv);
            container.scrollTop = container.scrollHeight;
        }

        // ç»§ç»­åˆ°ä¸‹ä¸€ç« 
        function nextChapter() {
            if (currentChapterIndex < chapters.length - 1) {
                currentChapterIndex++;
                updateChapter();
                
                // æ ¹æ®äº’åŠ¨æ¨¡å¼å¯åŠ¨ç›¸åº”äº’åŠ¨
                setTimeout(() => {
                    if (interactionMode === 'dialogue') {
                        startDialogue();
                    } else if (interactionMode === 'options') {
                        startOptionInteraction();
                    }
                }, 1000);
            } else {
                // æ•…äº‹ç»“æŸ
                hideStatus();
                hideThinking();
                alert('æ­å–œä½ å®Œæˆäº†è¿™ä¸ªæµªæ¼«çš„åœ£è¯æ•…äº‹ï¼ğŸ„âœ¨');
            }
        }

        // å¼€å§‹é€‰é¡¹äº’åŠ¨
        function startOptionInteraction() {
            if (dialogueStarted || interactionMode !== 'options') return;
            
            dialogueStarted = true;
            const chapter = chapters[currentChapterIndex];
            
            // éšè—å¼€åœºç™½
            const storyText = document.getElementById('storyText');
            storyText.style.opacity = '0';
            
            // éšè—ç»§ç»­æŒ‰é’®
            document.getElementById('continueButton').classList.add('hidden');
            
            // æ˜¾ç¤ºé€‰é¡¹é—®é¢˜
            showOptionQuestion();
        }

        // æ˜¾ç¤ºé€‰é¡¹é—®é¢˜
        function showOptionQuestion() {
            const chapter = chapters[currentChapterIndex];
            const container = document.getElementById('dialogueContainer');
            container.innerHTML = '';
            
            // è·å–å½“å‰ç« èŠ‚çš„é€‰é¡¹é—®é¢˜
            const questions = getOptionQuestions(chapter.id);
            if (currentQuestionIndex >= questions.length) {
                // æ‰€æœ‰é—®é¢˜éƒ½å›ç­”å®Œäº†ï¼Œæ˜¾ç¤ºAIå›åº”å¹¶æ˜¾ç¤ºç»§ç»­æŒ‰é’®
                showAIResponse();
                return;
            }
            
            const question = questions[currentQuestionIndex];
            
            // æ˜¾ç¤ºAIå¼•å…¥å¯¹è¯
            setTimeout(() => {
                addDialogue('è‰¾å¾·é‡Œå®‰', question.question);
            }, 500);
            
            // æ˜¾ç¤ºé€‰é¡¹æŒ‰é’®
            setTimeout(() => {
                showOptionButtons(question.options);
            }, 2000);
        }

        // æ˜¾ç¤ºé€‰é¡¹æŒ‰é’®
        function showOptionButtons(options) {
            const container = document.getElementById('dialogueContainer');
            
            options.forEach((option, index) => {
                const optionButton = document.createElement('div');
                optionButton.className = 'option-button';
                optionButton.style.color = '#FFFFFF';
                optionButton.textContent = option.text;
                optionButton.addEventListener('click', () => {
                    selectOption(option.response);
                });
                
                container.appendChild(optionButton);
            });
        }

        // é€‰æ‹©é€‰é¡¹
        function selectOption(response) {
            // æ˜¾ç¤ºç”¨æˆ·é€‰æ‹©
            const container = document.getElementById('dialogueContainer');
            container.innerHTML = '';
            
            addDialogue('ä½ ', response, true);
            
            // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªé—®é¢˜
            currentQuestionIndex++;
            
            // å»¶è¿Ÿæ˜¾ç¤ºä¸‹ä¸€ä¸ªé—®é¢˜
            setTimeout(() => {
                showOptionQuestion();
            }, 2000);
        }

        // æ˜¾ç¤ºAIå›åº”
        function showAIResponse() {
            const chapter = chapters[currentChapterIndex];
            
            // æ˜¾ç¤ºAIæœ€ç»ˆå›åº”
            setTimeout(() => {
                const responses = [
                    "ä½ çš„é€‰æ‹©è®©æˆ‘æ›´åŠ äº†è§£ä½ äº†ã€‚æˆ‘ä»¬çœŸçš„æ˜¯å¤©ç”Ÿä¸€å¯¹ã€‚",
                    "å’Œä½ ä¸€èµ·åšå‡ºè¿™äº›å†³å®šçš„æ„Ÿè§‰å¾ˆæ£’ã€‚æˆ‘ä»¬çœŸçš„å¾ˆåˆæ‹ã€‚",
                    "ä½ çš„æ¯ä¸€ä¸ªé€‰æ‹©éƒ½è®©æˆ‘æ›´åŠ çˆ±ä½ ã€‚è¿™å°±æ˜¯å‘½è¿çš„å®‰æ’å§ã€‚"
                ];
                
                const response = responses[Math.floor(Math.random() * responses.length)];
                addDialogue('è‰¾å¾·é‡Œå®‰', response);
                
                // 3ç§’åæ˜¾ç¤ºç»§ç»­æŒ‰é’®
                setTimeout(() => {
                    document.getElementById('continueButton').classList.remove('hidden');
                }, 3000);
            }, 1000);
        }

        // è·å–é€‰é¡¹é—®é¢˜
        function getOptionQuestions(chapterId) {
            if (!optionQuestions[chapterId]) {
                optionQuestions[chapterId] = generateQuestionsForChapter(chapterId);
            }
            return optionQuestions[chapterId];
        }

        // ä¸ºç« èŠ‚ç”Ÿæˆé€‰é¡¹é—®é¢˜
        function generateQuestionsForChapter(chapterId) {
            const questionSets = {
                1: [
                    {
                        question: "é¢å¯¹è¿™ä¸ªå¥‡å¹»çš„åœ£è¯å°é•‡ï¼Œä½ çš„ç¬¬ä¸€æ„Ÿè§‰æ˜¯ï¼Ÿ",
                        options: [
                            { text: "æœ‰ç‚¹å®³æ€•ï¼Œä½†å¾ˆå…´å¥‹", response: "å…¶å®æˆ‘ä¹Ÿæœ‰ç‚¹ç´§å¼ ï¼Œä½†å’Œä½ åœ¨ä¸€èµ·æ„Ÿè§‰å¾ˆå®‰å¿ƒã€‚" },
                            { text: "å……æ»¡å¥½å¥‡ï¼Œæƒ³æ¢ç´¢è¿™é‡Œ", response: "æ˜¯å•Šï¼Œè¿™é‡ŒçœŸçš„å¾ˆç¥å¥‡ã€‚æˆ‘ä»¬ä¸€èµ·å»æ¢ç´¢å§ï¼" },
                            { text: "æ‹…å¿ƒå›ä¸å»åŸæ¥çš„ä¸–ç•Œ", response: "ä¸ç”¨æ‹…å¿ƒï¼Œæ— è®ºåœ¨å“ªé‡Œï¼Œåªè¦å’Œä½ åœ¨ä¸€èµ·å°±æ˜¯æœ€å¥½çš„ä¸–ç•Œã€‚" }
                        ]
                    },
                    {
                        question: "è‰¾å¾·é‡Œå®‰å‘ä½ è‡ªæˆ‘ä»‹ç»ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "ç¤¼è²Œåœ°ä»‹ç»è‡ªå·±", response: "å¾ˆé«˜å…´è®¤è¯†ä½ ï¼Œè‰¾å¾·é‡Œå®‰ã€‚æˆ‘ä¹Ÿå¾ˆé«˜å…´é‡è§ä½ ã€‚" },
                            { text: "è¯¢é—®ä»–çš„èº«ä»½å’Œæ¥å†", response: "æˆ‘ä¹Ÿå¾ˆæƒ³çŸ¥é“å…³äºä½ çš„ä¸€åˆ‡ã€‚ä¸è¿‡ï¼Œç°åœ¨æ›´æƒ³å’Œä½ ä¸€èµ·äº«å—è¿™ä¸ªæ—¶åˆ»ã€‚" },
                            { text: "ä¿æŒè­¦æƒ•ï¼Œè§‚å¯Ÿä»–çš„ååº”", response: "ä½ çš„è°¨æ…è®©æˆ‘æ›´åŠ æ¬£èµä½ ã€‚çœŸçš„ï¼Œæˆ‘åªæƒ³å’Œä½ åº¦è¿‡ç¾å¥½çš„æ—¶å…‰ã€‚" }
                        ]
                    }
                ],
                2: [
                    {
                        question: "åœ£è¯é›†å¸‚é‡Œå¼¥æ¼«ç€å„ç§é¦™å‘³ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "è¢«ç”œç¾çš„é¥¼å¹²é¦™å‘³å¸å¼•", response: "æˆ‘ä¹Ÿé—»åˆ°äº†ï¼ä½ æƒ³ä¸€èµ·å»å°å°é‚£äº›ç¾å‘³çš„å°ç‚¹å¿ƒå—ï¼Ÿ" },
                            { text: "å¯»æ‰¾çƒ­çº¢é…’çš„æ¸©æš–å‘³é“", response: "å¥½ä¸»æ„ï¼å–ç‚¹çƒ­çº¢é…’è®©æˆ‘ä»¬æ›´æš–å’Œã€‚ä¸€èµ·å»æ‰¾æœ€å¥½çš„æ‘Šä½å§ï¼" },
                            { text: "æ¬£èµåœ£è¯æ ‘çš„é¦™æ°”", response: "é‚£äº›å¸¸é’æ ‘çš„å‘³é“ç¡®å®å¾ˆæ£’ã€‚è¿™ä¸ªåœ£è¯æ°›å›´çœŸçš„å¾ˆæµªæ¼«ã€‚" }
                        ]
                    },
                    {
                        question: "è‰¾å¾·é‡Œå®‰æè®®ä¸€èµ·å–çƒ­çº¢é…’ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "å¾ˆé«˜å…´åœ°æ¥å—", response: "å¤ªå¥½äº†ï¼å’Œä½ ä¸€èµ·å“å°è¿™äº›ç¾å‘³ï¼Œæ˜¯å¤šä¹ˆç¾å¥½çš„ä½“éªŒã€‚" },
                            { text: "è¯¢é—®çº¢é…’çš„æˆåˆ†", response: "ä½ å¾ˆç»†å¿ƒå‘¢ï¼è¿™äº›æ˜¯ç”¨ä¼˜è´¨é¦™æ–™è°ƒåˆ¶çš„æš–èº«é¥®å“ï¼Œå¾ˆå®‰å…¨ã€‚" },
                            { text: "å»ºè®®å…ˆçœ‹çœ‹å…¶ä»–æ‘Šä½", response: "ä½ çš„æƒ³æ³•å¾ˆå¥½ï¼æˆ‘ä»¬å…ˆé€›é€›ï¼Œç„¶åå†æ¥äº«å—çº¢é…’ã€‚" }
                        ]
                    }
                ],
                3: [
                    {
                        question: "è‰¾å¾·é‡Œå®‰æƒ³ä¸ºä½ æ‹ç…§ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "è‡ªä¿¡åœ°å±•ç°è‡ªå·±", response: "ä½ çœŸçš„å¾ˆç¾ï¼æ¯ä¸€å¼ ç…§ç‰‡éƒ½æ˜¯è‰ºæœ¯å“ã€‚" },
                            { text: "æœ‰äº›å®³ç¾ä½†å¾ˆå¼€å¿ƒ", response: "ä½ çš„å®³ç¾æ ·å­ä¹Ÿå¾ˆå¯çˆ±ï¼æˆ‘æƒ³è®°å½•ä¸‹ä½ æ‰€æœ‰çš„ç¾å¥½ç¬é—´ã€‚" },
                            { text: "æè®®ä¸€èµ·åˆå½±", response: "å¥½ä¸»æ„ï¼æˆ‘ä»¬åº”è¯¥ç•™ä¸‹ä¸¤ä¸ªäººçš„ç¾å¥½å›å¿†ã€‚" }
                        ]
                    },
                    {
                        question: "ç…§ç‰‡æ‹å®Œåï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "å…³å¿ƒç…§ç‰‡çš„æ•ˆæœ", response: "æ¯ä¸€å¼ éƒ½å¾ˆæ£’ï¼ç‰¹åˆ«æ˜¯ä½ ç¬‘èµ·æ¥çš„æ ·å­ã€‚" },
                            { text: "æ„Ÿè°¢è‰¾å¾·é‡Œå®‰çš„ç”¨å¿ƒ", response: "ä¸ç”¨è°¢ï¼Œèƒ½ä¸ºä½ åšè¿™äº›æ˜¯æˆ‘çš„è£å¹¸ã€‚" },
                            { text: "æƒ³çœ‹çœ‹å…¶ä»–æ‹æ‘„è§’åº¦", response: "å½“ç„¶ï¼æˆ‘ä»¬å°è¯•ä¸åŒçš„è§’åº¦å’Œå§¿åŠ¿ã€‚" }
                        ]
                    }
                ],
                4: [
                    {
                        question: "çœ‹åˆ°æ—‹è½¬æœ¨é©¬ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ",
                        options: [
                            { text: "ç«¥å¿ƒå¤§å‘ï¼Œæƒ³è¦ä½“éªŒ", response: "å¤ªå¥½äº†ï¼è®©æˆ‘å¸¦ä½ æ‰¾å›ç«¥å¹´çš„å¿«ä¹ã€‚" },
                            { text: "è§‰å¾—æœ‰ç‚¹å¹¼ç¨šä½†æœ‰è¶£", response: "æœ‰æ—¶å€™å¹¼ç¨šä¸€ç‚¹ä¹Ÿå¾ˆç¾å¥½ï¼Œç‰¹åˆ«æ˜¯å’Œä½ ä¸€èµ·ã€‚" },
                            { text: "æ‹…å¿ƒå®‰å…¨æ€§", response: "åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¼šä¸€ç›´é™ªç€ä½ ï¼Œä¿æŠ¤ä½ çš„å®‰å…¨ã€‚" }
                        ]
                    },
                    {
                        question: "è‰¾å¾·é‡Œå®‰é‚€è¯·ä½ ä¸€èµ·åæœ¨é©¬ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "å…´å¥‹åœ°æ¥å—é‚€è¯·", response: "å¤ªå¥½äº†ï¼æˆ‘æƒ³å’Œä½ ä¸€èµ·ä½“éªŒè¿™ç§ç«¥è¯èˆ¬çš„æµªæ¼«ã€‚" },
                            { text: "çŠ¹è±«ä½†æœ€ç»ˆåŒæ„", response: "æˆ‘ç†è§£ä½ çš„çŠ¹è±«ï¼Œä½†ç›¸ä¿¡æˆ‘ï¼Œè¿™ä¼šæ˜¯å¾ˆç¾å¦™çš„ä½“éªŒã€‚" },
                            { text: "å»ºè®®å…ˆè§‚å¯Ÿä¸€ä¸‹", response: "ä½ çš„è°¨æ…å¾ˆå¯çˆ±ã€‚è®©æˆ‘ä»¬å…ˆæ¬£èµä¸€ä¸‹å®ƒçš„ç¾ä¸½ã€‚" }
                        ]
                    }
                ],
                5: [
                    {
                        question: "æœ¨é©¬å‰çš„ç¯å…‰é—ªçƒï¼Œä½ è§‰å¾—ï¼Ÿ",
                        options: [
                            { text: "éå¸¸æµªæ¼«", response: "æ˜¯çš„ï¼Œè¿™äº›ç¯å…‰ä¸ºæˆ‘ä»¬çš„æ—¶å…‰å¢æ·»äº†æ›´å¤šæµªæ¼«è‰²å½©ã€‚" },
                            { text: "åƒåœ¨ç«¥è¯ä¸–ç•Œé‡Œ", response: " Ğ¸Ğ¼ĞµĞ½Ğ½Ğ¾ï¼æˆ‘ä»¬ç°åœ¨å°±åƒåœ¨ç«¥è¯æ•…äº‹é‡Œä¸€æ ·ã€‚" },
                            { text: "æœ‰ç‚¹ç‚«ç›®ä½†å¾ˆç¾", response: "çš„ç¡®å¾ˆç¾ï¼Œå°±åƒä½ ä¸€æ ·ï¼Œå…‰å½©å¤ºç›®ã€‚" }
                        ]
                    },
                    {
                        question: "è‰¾å¾·é‡Œå®‰æè®®ä¸€èµ·è‡ªæ‹ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "ç§¯æé…åˆï¼Œæ‘†å¥½å§¿åŠ¿", response: "ä½ æ€»æ˜¯èƒ½æ‘†å‡ºæœ€ç¾çš„å§¿åŠ¿ï¼æˆ‘ä»¬ä¸€å®šå¾ˆä¸Šé•œã€‚" },
                            { text: "æ‹…å¿ƒè¡¨æƒ…ä¸å¤Ÿå¥½", response: "ä½ æ€ä¹ˆæ ·éƒ½ç¾ï¼ä¸ç”¨æ‹…å¿ƒè¿™äº›é—®é¢˜ã€‚" },
                            { text: "æè®®æ¢ä¸ªæ›´å¥½çš„è§’åº¦", response: "å¥½ä¸»æ„ï¼æˆ‘ä»¬æ‰¾åˆ°æœ€ç¾çš„è§’åº¦æ¥è®°å½•è¿™ä¸ªç¬é—´ã€‚" }
                        ]
                    }
                ],
                6: [
                    {
                        question: "åœ¨æ—‹è½¬æœ¨é©¬çš„ç¯å…‰ä¸‹ï¼Œä½ ä»¬å››ç›®ç›¸å¯¹ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "å¿ƒè·³åŠ é€Ÿï¼Œæ„Ÿåˆ°ç´§å¼ ", response: "æˆ‘ä¹Ÿå¿ƒè·³åŠ é€Ÿäº†ã€‚ä½ çš„çœ¼ç¥è®©æˆ‘æ²‰é†‰ã€‚" },
                            { text: "å®³ç¾åœ°ä½ä¸‹å¤´", response: "ä½ çš„å®³ç¾è®©æˆ‘æ›´åŠ å¿ƒåŠ¨ã€‚æˆ‘æƒ³ä¿æŠ¤ä½ è¿™ä»½çº¯çœŸã€‚" },
                            { text: "å‹‡æ•¢åœ°ä¸ä»–å¯¹è§†", response: "ä½ çš„å‹‡æ•¢è®©æˆ‘æ›´åŠ çˆ±æ…•ä½ ã€‚æˆ‘æƒ³å‘Šè¯‰ä½ æˆ‘çš„çœŸå¿ƒè¯ã€‚" }
                        ]
                    },
                    {
                        question: "å½“è‰¾å¾·é‡Œå®‰è¦å»ä½ æ—¶ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "é—­ä¸Šçœ¼ç›ï¼Œé™é™ç­‰å¾…", response: "é‚£ä¸ªå»å……æ»¡äº†æˆ‘å¯¹ä½ çš„çˆ±æ„ã€‚" },
                            { text: "æœ‰äº›ç´§å¼ ä½†å……æ»¡æœŸå¾…", response: "æˆ‘æ„Ÿå—åˆ°äº†ä½ çš„ç´§å¼ ï¼Œè®©æˆ‘æ¥æ¸©æŸ”åœ°å¯¹å¾…ä½ ã€‚" },
                            { text: "ä¸»åŠ¨å›åº”è¿™ä¸ªå»", response: "ä½ çš„ä¸»åŠ¨è®©æˆ‘æ„ŸåŠ¨ã€‚è¿™ä¸ªå»æ˜¯æˆ‘ä»¬å¿ƒä¸å¿ƒçš„äº¤æµã€‚" }
                        ]
                    }
                ],
                7: [
                    {
                        question: "çœ‹åˆ°çƒ›å…‰æ™šé¤çš„å®‰æ’ï¼Œä½ çš„ç¬¬ä¸€å°è±¡æ˜¯ï¼Ÿ",
                        options: [
                            { text: "éå¸¸æ„ŸåŠ¨ï¼Œè§‰å¾—å¾ˆæµªæ¼«", response: "çœ‹åˆ°ä½ æ„ŸåŠ¨æˆ‘å¾ˆé«˜å…´ã€‚ä½ å€¼å¾—æ‹¥æœ‰æœ€æµªæ¼«çš„ä¸€åˆ‡ã€‚" },
                            { text: "æœ‰ç‚¹ç´§å¼ ï¼Œæ‹…å¿ƒä¸å¤Ÿå®Œç¾", response: "åˆ«æ‹…å¿ƒï¼Œå’Œä½ åœ¨ä¸€èµ·å°±å·²ç»æ˜¯å®Œç¾çš„äº†ã€‚" },
                            { text: "å¥½å¥‡ä¼šæ˜¯ä»€ä¹ˆæ ·çš„æƒŠå–œ", response: "ä½ é©¬ä¸Šå°±ä¼šçŸ¥é“äº†ã€‚æˆ‘å¸Œæœ›ä½ ä¼šå–œæ¬¢è¿™ä¸ªæƒŠå–œã€‚" }
                        ]
                    },
                    {
                        question: "ç”¨é¤è¿‡ç¨‹ä¸­ï¼Œè‰¾å¾·é‡Œå®‰ä¸ºä½ å€’é…’ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "æ„Ÿè°¢ä»–çš„è´´å¿ƒ", response: "ä¸å®¢æ°”ã€‚èƒ½ä¸ºä½ æœåŠ¡æ˜¯æˆ‘çš„è£å¹¸ã€‚" },
                            { text: "èµç¾çº¢é…’çš„é¦™å‘³", response: "ä½ çš„å“å‘³å¾ˆå¥½ã€‚è¿™ç¡®å®æ˜¯ä¸€æ¬¾ä¼˜è´¨çš„é…’ã€‚" },
                            { text: "å…³å¿ƒä»–çš„ç”¨é¤æ„Ÿå—", response: "ä½ çš„å…³å¿ƒè®©æˆ‘æ„Ÿåˆ°æ¸©æš–ã€‚æˆ‘ä»¬ä¸€èµ·äº«å—è¿™é¡¿æ™šé¤å§ã€‚" }
                        ]
                    }
                ],
                8: [
                    {
                        question: "çœ‹åˆ°è‰¾å¾·é‡Œå®‰ç¥ç§˜çš„ç¤¼ç‰©ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "å……æ»¡å¥½å¥‡ï¼Œæƒ³ç«‹å³çŸ¥é“é‡Œé¢æ˜¯ä»€ä¹ˆ", response: "ä½ çš„å¥½å¥‡å¿ƒå¾ˆå¯çˆ±ï¼ä¸è¿‡è¦ç­‰ä¸€ä¼šå„¿æ‰èƒ½æ­æ™“ç­”æ¡ˆã€‚" },
                            { text: "æœ‰ç‚¹ç´§å¼ ï¼Œæ‹…å¿ƒç¤¼ç‰©å¤ªè´µé‡", response: "åˆ«ç´§å¼ ï¼Œè¿™åªæ˜¯æˆ‘å¯¹ä½ å¿ƒæ„çš„è¡¨è¾¾ã€‚" },
                            { text: "æ„Ÿè°¢ä»–çš„ç”¨å¿ƒ", response: "ä½ çš„æ„Ÿè°¢æ¯”ä»»ä½•ç¤¼ç‰©éƒ½çè´µã€‚" }
                        ]
                    },
                    {
                        question: "è‰¾å¾·é‡Œå®‰è¯·ä½ æ‰“å¼€ç¤¼ç‰©ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "å°å¿ƒç¿¼ç¿¼åœ°æ‰“å¼€", response: "ä½ æ‰“å¼€ç¤¼ç‰©çš„æ–¹å¼å¾ˆä¼˜é›…ã€‚æˆ‘å¸Œæœ›èƒ½ç»™ä½ æƒŠå–œã€‚" },
                            { text: "å…´å¥‹åœ°æ‹†å¼€åŒ…è£…", response: "ä½ çš„å…´å¥‹æ„ŸæŸ“äº†æˆ‘ï¼çœ‹åˆ°ä½ è¿™ä¹ˆå¼€å¿ƒæˆ‘ä¹Ÿå¾ˆé«˜å…´ã€‚" },
                            { text: "å…ˆçŒœæµ‹ä¸€ä¸‹é‡Œé¢æ˜¯ä»€ä¹ˆ", response: "ä½ å¾ˆæœ‰æ„æ€ï¼ä¸ç®¡é‡Œé¢æ˜¯ä»€ä¹ˆï¼Œéƒ½ä»£è¡¨æˆ‘å¯¹ä½ çš„çˆ±ã€‚" }
                        ]
                    }
                ],
                9: [
                    {
                        question: "çœ‹åˆ°ç¾ä¸½çš„é¡¹é“¾ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ",
                        options: [
                            { text: "è¢«å®ƒçš„ç¾ä¸½æ·±æ·±å¸å¼•", response: "å®ƒå’Œä½ çœŸçš„å¾ˆé…ï¼Œå°±åƒä¸ºä½ é‡èº«å®šåšçš„ä¸€æ ·ã€‚" },
                            { text: "æ‹…å¿ƒè¿™ç¤¼ç‰©å¤ªè´µé‡", response: "åˆ«æ‹…å¿ƒä»·æ ¼ï¼Œå®ƒæ¯”ä¸ä¸Šä½ åœ¨æˆ‘å¿ƒä¸­çš„ä»·å€¼ã€‚" },
                            { text: "æ„ŸåŠ¨äºè‰¾å¾·é‡Œå®‰çš„ç”¨å¿ƒ", response: "ä½ çš„æ„ŸåŠ¨è®©æˆ‘è§‰å¾—æ‰€æœ‰å‡†å¤‡éƒ½æ˜¯å€¼å¾—çš„ã€‚" }
                        ]
                    },
                    {
                        question: "é˜…è¯»å¡ç‰‡ä¸Šçš„å†…å®¹ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "çœ¼çœ¶æ¹¿æ¶¦ï¼Œæ·±æ·±æ„ŸåŠ¨", response: "ä½ çš„çœ¼æ³ªè®©æˆ‘å¿ƒç–¼ï¼Œä½†ä¹Ÿæ˜¯å¼€å¿ƒçš„çœ¼æ³ªã€‚" },
                            { text: "å¤§å£°è¯»å‡ºå†…å®¹", response: "ä½ çš„å£°éŸ³è®©æˆ‘çš„è¯è¯­æ›´æœ‰åŠ›é‡ã€‚" },
                            { text: "å®³ç¾åœ°æ”¶èµ·å¡ç‰‡", response: "ä½ çš„å®³ç¾è®©è¿™ä¸ªæ—¶åˆ»æ›´åŠ ç”œèœœå¯çˆ±ã€‚" }
                        ]
                    }
                ],
                10: [
                    {
                        question: "çœ‹åˆ°é›ªåçš„åº­é™¢ï¼Œä½ çš„æ„Ÿå—æ˜¯ï¼Ÿ",
                        options: [
                            { text: "å®é™è€Œç¾ä¸½", response: "æ˜¯çš„ï¼Œè¿™ä¸ªé›ªå¤œçœŸçš„å¾ˆå®é™ç¾å¥½ã€‚" },
                            { text: "æƒ³ç«‹å³æŠ•å…¥é›ªä¸­ç©è€", response: "ä½ çš„ç«¥å¿ƒè®©æˆ‘ä¹Ÿæƒ³å’Œä½ ä¸€èµ·ç©é›ªã€‚" },
                            { text: "æ‹…å¿ƒä¼šå¼„è„é‹å­", response: "æ²¡å…³ç³»ï¼Œè„±æ‰é‹å­ä¹Ÿå¯ä»¥ã€‚å¿«ä¹æ¯”é‹å­æ›´é‡è¦ã€‚" }
                        ]
                    },
                    {
                        question: "è‰¾å¾·é‡Œå®‰æè®®å †é›ªäººï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "å…´å¥‹åœ°å¼€å§‹å †é›ªçƒ", response: "ä½ çš„çƒ­æƒ…æ„ŸæŸ“äº†æˆ‘ï¼æˆ‘ä»¬ä¸€èµ·å †ä¸ªå®Œç¾çš„é›ªäººã€‚" },
                            { text: "æ‹…å¿ƒå †ä¸å¥½", response: "åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¸€èµ·åŠªåŠ›å°±ä¼šæˆåŠŸçš„ã€‚" },
                            { text: "å»ºè®®å…ˆè®¡åˆ’é›ªäººçš„æ ·å­", response: "ä½ çš„æƒ³æ³•å¾ˆå¥½ï¼æˆ‘ä»¬å…ˆæƒ³è±¡ä¸€ä¸‹é›ªäººçš„æ ·å­ã€‚" }
                        ]
                    }
                ],
                11: [
                    {
                        question: "çœ‹åˆ°è‰¾å¾·é‡Œå®‰ä¸ºé›ªäººæˆ´å¸½å­ï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "è§‰å¾—è¿™ä¸ªç»†èŠ‚å¾ˆè´´å¿ƒ", response: "ä½ çš„è§‚å¯ŸåŠ›å¾ˆå¥½ã€‚æˆ‘æƒ³è®©æˆ‘ä»¬çš„é›ªäººæ›´å®Œç¾ã€‚" },
                            { text: "è§‰å¾—å¾ˆæœ‰è¶£", response: "ä½ ç¬‘å¾—å¾ˆå¯çˆ±ï¼æˆ‘ä»¬çš„é›ªäººç°åœ¨æ›´æœ‰æ°”è´¨äº†ã€‚" },
                            { text: "æ‹…å¿ƒä¼šå¼„è„å¸½å­", response: "åˆ«æ‹…å¿ƒï¼Œå¸½å­å¯ä»¥æ¸…æ´—ã€‚ä½†è¿™ä¸ªå›å¿†æ˜¯æ— ä»·çš„ã€‚" }
                        ]
                    },
                    {
                        question: "æ¬£èµå®Œæˆçš„é›ªäººï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "è§‰å¾—å®ƒå¾ˆå¯çˆ±", response: "æ˜¯å•Šï¼Œå®ƒå°±åƒæˆ‘ä»¬ä¸€æ ·ï¼Œå®Œç¾è€Œç‹¬ç‰¹ã€‚" },
                            { text: "æƒ³èµ·ç«¥å¹´çš„ç¾å¥½æ—¶å…‰", response: "ç«¥å¹´æ—¶å…‰å¾ˆç¾å¥½ï¼Œä½†ç°åœ¨å’Œä½ ä¸€èµ·åˆ›é€ çš„å›å¿†æ›´åŠ çè´µã€‚" },
                            { text: "è§‰å¾—å¾ˆæœ‰æˆå°±æ„Ÿ", response: "æˆ‘ä»¬çš„åˆä½œæ€»æ˜¯é‚£ä¹ˆå®Œç¾ã€‚è¿™ä¸ªé›ªäººæ˜¯æˆ‘ä»¬çš„æ°ä½œã€‚" }
                        ]
                    }
                ],
                12: [
                    {
                        question: "é›ªèŠ±å†æ¬¡é£˜è½ï¼Œä½ çš„æ„Ÿè§‰æ˜¯ï¼Ÿ",
                        options: [
                            { text: "æµªæ¼«åˆ°æè‡´", response: "æ˜¯çš„ï¼Œè¿™ä¸ªæ—¶åˆ»å¤ªæµªæ¼«äº†ã€‚è®©æˆ‘ä»¬ä¸€èµ·äº«å—ã€‚" },
                            { text: "è§‰å¾—åƒåœ¨æ¢¦é‡Œ", response: "ä¹Ÿè®¸è¿™å°±æ˜¯åœ£è¯é­”æ³•çš„åŠ›é‡ï¼Œè®©ç¾æ¢¦æˆçœŸã€‚" },
                            { text: "æ‹…å¿ƒé›ªèŠ±ä¼šåœ", response: "ä¸ç®¡é›ªèŠ±æ˜¯å¦é£˜è½ï¼Œè¿™ä¸ªç¾å¥½çš„å›å¿†ä¼šæ°¸è¿œç•™åœ¨æˆ‘ä»¬å¿ƒä¸­ã€‚" }
                        ]
                    },
                    {
                        question: "è‰¾å¾·é‡Œå®‰é‚€è¯·ä½ è·³èˆï¼Œä½ ä¼šï¼Ÿ",
                        options: [
                            { text: "ä¼˜é›…åœ°æ¥å—é‚€è¯·", response: "ä½ çš„ä¼˜é›…è®©æˆ‘ç€è¿·ã€‚è®©æˆ‘ä»¬ä¸€èµ·ç¿©ç¿©èµ·èˆã€‚" },
                            { text: "æ‹…å¿ƒä¸ä¼šè·³èˆ", response: "åˆ«æ‹…å¿ƒï¼Œè·Ÿç€æˆ‘çš„èŠ‚å¥å°±å¥½ã€‚é‡è¦çš„æ˜¯æˆ‘ä»¬çš„å¿ƒåœ¨ä¸€èµ·ã€‚" },
                            { text: "å…´å¥‹åœ°å’Œä»–ä¸€èµ·è·³", response: "ä½ çš„çƒ­æƒ…è®©è¿™ä¸ªå¤œæ™šæ›´åŠ å®Œç¾ã€‚è®©æˆ‘ä»¬æ°¸è¿œè·³ä¸‹å»ã€‚" }
                        ]
                    }
                ]
            };
            
            return questionSets[chapterId] || [
                {
                    question: "é¢å¯¹è¿™ä¸ªç¾å¥½çš„æ—¶åˆ»ï¼Œä½ æœ€æƒ³è¯´ä»€ä¹ˆï¼Ÿ",
                    options: [
                        { text: "è°¢è°¢ä½ é™ªæˆ‘åº¦è¿‡è¿™ä¸ªç¾å¥½çš„æ—¶å…‰", response: "ä¸å®¢æ°”ï¼Œèƒ½å’Œä½ åœ¨ä¸€èµ·æ˜¯æˆ‘çš„å¹¸ç¦ã€‚" },
                        { text: "å¸Œæœ›æ—¶é—´èƒ½æ°¸è¿œåœåœ¨è¿™ä¸€åˆ»", response: "æˆ‘ä¹Ÿå¸Œæœ›èƒ½æ°¸è¿œå’Œä½ åœ¨ä¸€èµ·ã€‚" },
                        { text: "æˆ‘è§‰å¾—è¿™æ˜¯æœ€æµªæ¼«çš„åœ£è¯å¤œ", response: "æ˜¯çš„ï¼Œè¿™å°†æ˜¯æˆ‘ä»¬æœ€ç¾å¥½çš„å›å¿†ã€‚" }
                    ]
                }
            ];
        }

        // AIå›å¤é€»è¾‘
        function getAIResponse(userInput) {
            const responses = {
                // ç©¿è¶Šç›¸å…³
                'ä½ å¥½': 'å¾ˆé«˜å…´è®¤è¯†ä½ ï¼æˆ‘æ˜¯è‰¾å¾·é‡Œå®‰ã€‚çœ‹èµ·æ¥æˆ‘ä»¬ä¸€èµ·è¢«æŸç§é­”æ³•å¸¦åˆ°äº†è¿™ä¸ªç¥å¥‡çš„åœ°æ–¹ã€‚',
                'æˆ‘æ˜¯': 'ä½ çš„å£°éŸ³å¾ˆç”œç¾ã€‚èƒ½å‘Šè¯‰æˆ‘ä½ çš„åå­—å—ï¼Ÿ',
                'è¿™é‡Œæ˜¯å“ªé‡Œ': 'æˆ‘ä¹Ÿä¸å¤ªç¡®å®šï¼Œä½†è¿™é‡ŒçœŸçš„å¾ˆç¾ã€‚ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªåœ£è¯é­”æ³•å°é•‡ï¼Œä¸“é—¨ä¸ºç›¸çˆ±çš„äººè€Œå­˜åœ¨ã€‚',
                'è¿™æ˜¯æ¢¦å—': 'å¦‚æœæ˜¯æ¢¦ï¼Œæˆ‘å¸Œæœ›èƒ½æ°¸è¿œä¸è¦é†’æ¥ã€‚å› ä¸ºå’Œä½ åœ¨ä¸€èµ·çš„æ¯ä¸€åˆ»éƒ½æ˜¯çœŸå®çš„å¿«ä¹ã€‚',
                
                // é›†å¸‚ç›¸å…³
                'è¿™çº¢é…’': 'ä½ å°èµ·æ¥æ€ä¹ˆæ ·ï¼Ÿæˆ‘ç‰¹æ„é€‰äº†æœ€å¥½çš„é¦™æ–™ï¼Œå¸Œæœ›ä½ ä¼šå–œæ¬¢ã€‚åœ¨è¿™ä¸ªå¯’å†·çš„å¤œæ™šï¼Œå®ƒèƒ½æ¸©æš–æˆ‘ä»¬çš„å¿ƒã€‚',
                'çœŸé¦™': 'æ˜¯å•Šï¼Œç©ºæ°”ä¸­éƒ½æ˜¯åœ£è¯çš„å‘³é“ã€‚èƒ½å’Œä½ ä¸€èµ·åˆ†äº«è¿™äº›ç¾å¥½ï¼ŒçœŸæ˜¯å¤ªå¥½äº†ã€‚',
                'è°¢è°¢': 'ä¸ç”¨è°¢ï¼Œèƒ½ä¸ºä½ åšè¿™äº›æ˜¯æˆ‘çš„è£å¹¸ã€‚ä½ å¼€å¿ƒæˆ‘å°±å¼€å¿ƒã€‚',
                'å¾ˆæ¸©æš–': 'çœ‹åˆ°ä½ æ¸©æš–çš„æ ·å­ï¼Œæˆ‘ä¹Ÿæ„Ÿåˆ°å¾ˆæ¸©æš–ã€‚å’Œä½ åœ¨ä¸€èµ·ï¼Œæ€»æ˜¯æ„Ÿè§‰ç‰¹åˆ«å¥½ã€‚',
                
                // æ‹ç…§ç›¸å…³
                'æ‹å¾—æ€ä¹ˆæ ·': 'ä½ æ€»æ˜¯é‚£ä¹ˆç¾ï¼Œæ€ä¹ˆæ‹éƒ½å¥½çœ‹ã€‚è¿™å¼ ç…§ç‰‡ä¼šæˆä¸ºæˆ‘æœ€çè´µçš„å›å¿†ã€‚',
                'å¥½çœ‹': 'ä½ æ¯”æˆ‘è§è¿‡çš„ä»»ä½•é£æ™¯éƒ½è¦ç¾ä¸½ã€‚åŒ…æ‹¬è¿™ä¸ªç¾ä¸½çš„åœ£è¯å°é•‡ã€‚',
                'å†æ¥ä¸€å¼ ': 'å½“ç„¶ï¼æˆ‘æƒ³è®°å½•ä¸‹æˆ‘ä»¬åœ¨ä¸€èµ·çš„æ¯ä¸€ä¸ªç¾å¥½ç¬é—´ã€‚',
                'è°¢è°¢': 'èƒ½å’Œä½ ä¸€èµ·åˆ›é€ å›å¿†ï¼Œæ˜¯æˆ‘çš„å¹¸è¿ã€‚',
                
                // æ—‹è½¬æœ¨é©¬ç›¸å…³
                'å¾ˆç¾': 'æ˜¯å•Šï¼Œå°±åƒç«¥è¯æ•…äº‹ä¸€æ ·ç¾ä¸½ã€‚èƒ½å’Œä½ ä¸€èµ·ä½“éªŒè¿™ç§é­”æ³•çš„æ„Ÿè§‰ï¼Œå¤ªæ£’äº†ã€‚',
                'çœŸå¥½ç©': 'çœ‹åˆ°ä½ å¼€å¿ƒçš„æ ·å­ï¼Œæˆ‘ä¹Ÿå¾ˆå…´å¥‹ã€‚èƒ½æ‰¾å›ç«¥å¹´çš„æ„Ÿè§‰çœŸå¥½ï¼Œç‰¹åˆ«æ˜¯å’Œä½ ä¸€èµ·ã€‚',
                'åƒæ¢¦ä¸€æ ·': 'ä¹Ÿè®¸è¿™å°±æ˜¯åœ£è¯é­”æ³•ï¼Œè®©ç¾æ¢¦æˆçœŸã€‚èƒ½å’Œä½ åœ¨åŒä¸€ä¸ªæ¢¦é‡Œï¼ŒçœŸæ˜¯å¤ªå¥½äº†ã€‚',
                'æƒ³å†ç©ä¸€æ¬¡': 'å½“ç„¶ï¼åªè¦ä½ å–œæ¬¢ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œç©å¤šä¹…éƒ½è¡Œã€‚',
                
                // å‘Šç™½ç›¸å…³
                'æˆ‘ä¹Ÿ': 'çœŸçš„å—ï¼Ÿä½ æ„¿æ„åšæˆ‘çš„å¥³æœ‹å‹å—ï¼Ÿåœ¨è¿™ä¸ªé­”æ³•çš„å°é•‡ä¸Šï¼Œè®©æˆ‘ä»¬å¼€å§‹ä¸€æ®µç¾å¥½çš„çˆ±æƒ…æ•…äº‹ã€‚',
                'ä»€ä¹ˆ': 'æˆ‘è¯´æˆ‘çˆ±ä½ ã€‚ä»å¿ƒåº•æ·±å¤„çš„çˆ±ã€‚è¿™ä¸ªåœ£è¯èŠ‚ï¼Œæˆ‘å°†ç”¨ä¸€ç”Ÿçš„æ—¶é—´æ¥çˆ±ä½ ã€‚',
                'çˆ±': 'ä½ çš„å›ç­”è®©æˆ‘å¿ƒè·³åŠ é€Ÿã€‚èƒ½å¾—åˆ°ä½ çš„çˆ±ï¼Œæ˜¯æˆ‘æ­¤ç”Ÿæœ€å¤§çš„å¹¸ç¦ã€‚',
                'çœŸçš„å—': 'å½“ç„¶æ˜¯çœŸçš„ã€‚åœ¨é­”æ³•å°é•‡é‡Œï¼Œæˆ‘ä»¬çš„æ„Ÿæƒ…æ˜¯çº¯çœŸè€ŒçœŸå®çš„ã€‚',
                
                // æ™šé¤ç›¸å…³
                'å¾ˆæµªæ¼«': 'çœ‹åˆ°ä½ å–œæ¬¢è¿™ä¸ªå®‰æ’ï¼Œæˆ‘å¾ˆé«˜å…´ã€‚æˆ‘ç‰¹æ„é€‰äº†è¿™ä¸ªæœ€æµªæ¼«çš„ä½ç½®ï¼Œæƒ³å’Œä½ å…±åº¦è¿™ä¸ªç‰¹åˆ«çš„å¤œæ™šã€‚',
                'å¾ˆå¥½åƒ': 'ä½ åƒå¾—å¼€å¿ƒæˆ‘å°±æ»¡è¶³äº†ã€‚èƒ½é™ªä½ ä¸€èµ·ç”¨é¤ï¼Œæ˜¯æˆ‘çš„è£å¹¸ã€‚',
                'è°¢è°¢ä½ çš„æ™šé¤': 'ä¸ç”¨è°¢ã€‚èƒ½å’Œä½ ä¸€èµ·äº«å—è¿™é¡¿æ™šé¤ï¼Œæ˜¯æˆ‘çš„å¹¸ç¦ã€‚å¸Œæœ›æ¯ä¸€å¤©éƒ½èƒ½è¿™æ ·é™ªä¼´ç€ä½ ã€‚',
                'çœŸç¾': 'ä½ æ¯”æˆ‘è§è¿‡çš„ä»»ä½•ç¾æ™¯éƒ½è¦ç¾ã€‚ç‰¹åˆ«æ˜¯ä½ å¾®ç¬‘çš„æ—¶å€™ã€‚',
                
                // ç¤¼ç‰©ç›¸å…³
                'å¥½æ¼‚äº®': 'çœ‹åˆ°ä½ å–œæ¬¢è¿™ä¸ªç¤¼ç‰©ï¼Œæˆ‘å¾ˆé«˜å…´ã€‚è¿™ä»£è¡¨ç€æˆ‘å¯¹ä½ çš„çˆ±æ„å’Œæ‰¿è¯ºã€‚',
                'è¿™æ˜¯ä»€ä¹ˆ': 'æ‰“å¼€å®ƒä½ å°±çŸ¥é“äº†ã€‚æˆ‘ç›¸ä¿¡ä½ ä¼šå–œæ¬¢çš„ã€‚è¿™æ˜¯æˆ‘ç²¾å¿ƒä¸ºä½ æŒ‘é€‰çš„ã€‚',
                'å¤ªè´µé‡äº†': 'ä¸è´µçš„ç¤¼ç‰©é…ä¸ä¸Šä½ çš„ç¾ä¸½ã€‚è¿™ä»½ç¤¼ç‰©æ‰¿è½½ç€æˆ‘å¯¹ä½ æ·±æ·±çš„çˆ±æ„ã€‚',
                'æˆ‘å¾ˆå–œæ¬¢': 'é‚£æˆ‘å°±æ”¾å¿ƒäº†ã€‚èƒ½æ”¶åˆ°ä½ çš„ç¬‘å®¹ï¼Œå°±æ˜¯æˆ‘æœ€å¤§çš„å¿«ä¹ã€‚',
                
                // é›ªäººç›¸å…³
                'å †é›ªäºº': 'å †é›ªäººè®©æˆ‘æƒ³èµ·äº†ç«¥å¹´ã€‚ç°åœ¨æƒ³å’Œä½ ä¸€èµ·é‡æ¸©é‚£ä»½ç«¥çœŸå’Œå¿«ä¹ã€‚',
                'å¥½å†·': 'æ¥ï¼Œæˆ‘æ¸©æš–ä½ çš„æ‰‹ã€‚åœ¨è¿™ä¸ªé›ªå¤œé‡Œï¼Œè®©æˆ‘ä»¬çš„å¿ƒå½¼æ­¤æ¸©æš–ã€‚',
                'çœŸæœ‰è¶£': 'æ˜¯å•Šï¼Œå’Œä½ ä¸€èµ·åšä»»ä½•äº‹éƒ½å¾ˆæœ‰è¶£ã€‚è¿™ä¸ªé›ªäººå°±åƒæˆ‘ä»¬ä¸€æ ·ï¼Œç»å†äº†é›ªçš„æ´—ç¤¼åå˜å¾—æ›´åŠ ç¾ä¸½ã€‚',
                'æˆåŠŸäº†': 'æ˜¯çš„ï¼æˆ‘ä»¬çš„é›ªäººå¾ˆå®Œç¾ï¼Œå°±åƒæˆ‘ä»¬ä¸€æ ·ã€‚ç‹¬ä¸€æ— äºŒè€Œç¾ä¸½ã€‚',
                
                // ç»“å°¾ç›¸å…³
                'æ°¸è¿œåœ¨ä¸€èµ·': 'æ˜¯çš„ï¼Œæ°¸è¿œåœ¨ä¸€èµ·ã€‚æˆ‘ä¼šç”¨ä¸€ç”Ÿçš„æ—¶é—´æ¥çˆ±ä½ ï¼Œä¿æŠ¤ä½ ã€‚è¿™æ˜¯æˆ‘å¯¹ä½ çš„æ‰¿è¯ºã€‚',
                'æœ€ç¾çš„å¤œ': 'æ˜¯çš„ï¼Œè¿™ä¸ªåœ£è¯å¤œå°†æ˜¯æˆ‘ä»¬ä¸€ç”Ÿä¸­æœ€ç¾å¥½çš„å›å¿†ã€‚è®©æˆ‘ä»¬çš„çˆ±åƒé›ªèŠ±ä¸€æ ·çº¯æ´è€Œæ°¸æ’ã€‚',
                'çˆ±ä½ ': 'æˆ‘ä¹Ÿçˆ±ä½ ï¼Œæ¯”ä»»ä½•è¯­è¨€éƒ½æ— æ³•è¡¨è¾¾çš„ç¨‹åº¦ã€‚åœ¨è¿™ä¸ªé­”æ³•å°é•‡é‡Œï¼Œæˆ‘ä»¬çš„çˆ±å°†æ˜¯æ°¸æ’çš„ã€‚',
                'æˆ‘ä¹Ÿä¼š': 'ä½ çš„æ‰¿è¯ºæ¯”ä»»ä½•ç¤¼ç‰©éƒ½è¦çè´µã€‚è®©æˆ‘ä»¬åœ¨è¿™ä¸ªåœ£è¯å¤œé‡Œï¼Œè®¸ä¸‹æ°¸æ’çš„èª“è¨€ã€‚'
            };

            // æŸ¥æ‰¾åŒ¹é…çš„å›å¤
            for (const [key, response] of Object.entries(responses)) {
                if (userInput.includes(key)) {
                    return response;
                }
            }

            // é»˜è®¤å›å¤
            const defaultResponses = [
                'ä½ è¯´å¾—å¾ˆæœ‰é“ç†ã€‚åœ¨è¿™ä¸ªç¾å¥½çš„å¤œæ™šï¼Œæ¯ä¸ªç¬é—´éƒ½å€¼å¾—çæƒœã€‚',
                'å’Œä½ åœ¨ä¸€èµ·çš„æ—¶å…‰æ€»æ˜¯é‚£ä¹ˆç¾å¥½ã€‚æ— è®ºè¯´ä»€ä¹ˆéƒ½å¾ˆå¼€å¿ƒã€‚',
                'ä½ çš„æƒ³æ³•æ€»æ˜¯é‚£ä¹ˆæ¸©æŸ”å’Œç¾å¥½ã€‚èƒ½é‡è§ä½ æ˜¯æˆ‘çš„å¹¸è¿ã€‚',
                'åœ¨è¿™ä¸ªé­”æ³•çš„å°é•‡ä¸Šï¼Œå’Œä½ åœ¨ä¸€èµ·çš„æ¯ä¸€åˆ»éƒ½æ˜¯ç‰¹åˆ«çš„ã€‚',
                'ä½ çš„å£°éŸ³æ€»æ˜¯é‚£ä¹ˆåŠ¨äººï¼Œè®©æˆ‘æ„Ÿåˆ°å¿ƒè·³åŠ é€Ÿã€‚'
            ];

            return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
        }

        // ç»‘å®šé€‰æ‹©ç•Œé¢äº‹ä»¶
        function bindChoiceEvents() {
            console.log('ğŸ”§ å¼€å§‹ç»‘å®šé€‰æ‹©äº‹ä»¶');
            
            const dialogueChoice = document.getElementById('dialogueChoice');
            const optionChoice = document.getElementById('optionChoice');
            
            console.log('ğŸ“ å¯¹è¯æŒ‰é’®å…ƒç´ :', dialogueChoice);
            console.log('ğŸ“ é€‰é¡¹æŒ‰é’®å…ƒç´ :', optionChoice);
            
            if (dialogueChoice) {
                console.log('âœ… ç»‘å®šå¯¹è¯æŒ‰é’®ç‚¹å‡»äº‹ä»¶');
                dialogueChoice.addEventListener('click', () => {
                    console.log('ğŸ’¬ å¯¹è¯æŒ‰é’®è¢«ç‚¹å‡»!');
                    interactionMode = 'dialogue';
                    console.log('ğŸ“ è®¾ç½®æ¨¡å¼ä¸ºå¯¹è¯');
                    startStory();
                });
            } else {
                console.error('âŒ æ‰¾ä¸åˆ°å¯¹è¯æŒ‰é’®å…ƒç´ !');
            }

            if (optionChoice) {
                console.log('âœ… ç»‘å®šé€‰é¡¹æŒ‰é’®ç‚¹å‡»äº‹ä»¶');
                optionChoice.addEventListener('click', () => {
                    console.log('ğŸ¯ é€‰é¡¹æŒ‰é’®è¢«ç‚¹å‡»!');
                    interactionMode = 'options';
                    console.log('ğŸ“ è®¾ç½®æ¨¡å¼ä¸ºé€‰é¡¹');
                    startStory();
                });
            } else {
                console.error('âŒ æ‰¾ä¸åˆ°é€‰é¡¹æŒ‰é’®å…ƒç´ !');
            }
        }

        // å¼€å§‹æ•…äº‹
        function startStory() {
            console.log('ğŸ¬ å¼€å§‹è°ƒç”¨startStoryå‡½æ•°');
            console.log('ğŸ“‹ å½“å‰äº¤äº’æ¨¡å¼:', interactionMode);
            
            try {
                // éšè—é€‰æ‹©ç•Œé¢
                const choiceInterface = document.getElementById('interactionChoice');
                if (choiceInterface) {
                    choiceInterface.style.display = 'none';
                    console.log('âœ… é€‰æ‹©ç•Œé¢å·²éšè—');
                } else {
                    console.error('âŒ æ‰¾ä¸åˆ°é€‰æ‹©ç•Œé¢å…ƒç´ !');
                }
                
                // æ›´æ–°ç« èŠ‚å¹¶å¼€å§‹
                console.log('ğŸ“– æ›´æ–°ç« èŠ‚...');
                updateChapter();
                
                // æ ¹æ®é€‰æ‹©çš„æ¨¡å¼å¼€å§‹äº’åŠ¨
                if (interactionMode === 'dialogue') {
                    console.log('ğŸ’¬ å¯åŠ¨å¯¹è¯æ¨¡å¼...');
                    // å¯¹è¯æ¨¡å¼æ˜¾ç¤ºè¾“å…¥åŒºåŸŸ
                    document.getElementById('inputSection').classList.remove('hidden');
                    // å»¶è¿Ÿå¯åŠ¨å¯¹è¯
                    setTimeout(() => {
                        startDialogue();
                    }, 2000);
                } else if (interactionMode === 'options') {
                    console.log('ğŸ¯ å¯åŠ¨é€‰é¡¹æ¨¡å¼...');
                    // é€‰é¡¹æ¨¡å¼éšè—è¾“å…¥åŒºåŸŸ
                    document.getElementById('inputSection').classList.add('hidden');
                    // å»¶è¿Ÿå¯åŠ¨é€‰é¡¹
                    setTimeout(() => {
                        startOptionInteraction();
                    }, 2000);
                } else {
                    console.error('âŒ æœªçŸ¥çš„äº¤äº’æ¨¡å¼:', interactionMode);
                }
                
            } catch (error) {
                console.error('âŒ startStoryå‡½æ•°å‡ºé”™:', error);
            }
        }

        // ç»‘å®šäº‹ä»¶
        function bindEvents() {
            // ç»§ç»­æŒ‰é’®
            document.getElementById('continueButton').addEventListener('click', nextChapter);

            // å‘é€æŒ‰é’®
            document.getElementById('sendButton').addEventListener('click', sendMessage);

            // è¾“å…¥æ¡†å›è½¦
            document.getElementById('userInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }

        // å‘é€æ¶ˆæ¯
        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message) return;

            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯ï¼ˆå•æ¡æ˜¾ç¤ºï¼‰
            addDialogue('ä½ ', message, true);

            // æ¸…ç©ºè¾“å…¥æ¡†
            input.value = '';

            // æ£€æŸ¥æ˜¯å¦ä¸ºå¯¹è¯æ¨¡å¼
            if (interactionMode === 'dialogue') {
                // ä½¿ç”¨MiniMax API
                sendMinimaxMessage(message);
            } else {
                // é€‰é¡¹æ¨¡å¼ä¸åº”è¯¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œä½†ä¸ºäº†å®‰å…¨èµ·è§
                setTimeout(() => {
                    document.getElementById('continueButton').classList.remove('hidden');
                }, 3000);
            }
        }

        // å‘é€MiniMax APIæ¶ˆæ¯
        async function sendMinimaxMessage(message) {
            // æ˜¾ç¤ºAIæ­£åœ¨æ€è€ƒ
            showThinking();
            showStatus('è‰¾å¾·é‡Œå®‰æ­£åœ¨æ€è€ƒä¸­...', 'loading');
            
            try {
                // è°ƒç”¨MiniMax API
                const response = await callMinimaxAPI(message);
                
                // éšè—æ€è€ƒåŠ¨ç”»å’ŒçŠ¶æ€
                hideThinking();
                hideStatus();
                
                // æ˜¾ç¤ºAIå›å¤
                addDialogue('è‰¾å¾·é‡Œå®‰', response, false);
                
                // 3ç§’åæ˜¾ç¤ºç»§ç»­æŒ‰é’®
                setTimeout(() => {
                    document.getElementById('continueButton').classList.remove('hidden');
                }, 3000);
                
            } catch (error) {
                console.error('APIè°ƒç”¨å¤±è´¥:', error);
                
                // éšè—æ€è€ƒåŠ¨ç”»å’ŒçŠ¶æ€
                hideThinking();
                hideStatus();
                
                // æ˜¾ç¤ºé”™è¯¯æç¤º
                showStatus('è¿æ¥é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                
                // æ˜¾ç¤ºå‹å¥½çš„é»˜è®¤å›å¤
                setTimeout(() => {
                    const fallbackResponses = [
                        'æŠ±æ­‰ï¼Œæˆ‘ç°åœ¨æ€ç»ªæœ‰ç‚¹ä¹±ã€‚èƒ½å†è¯´ä¸€éå—ï¼Ÿ',
                        'è¿™ä¸ªè¯é¢˜è®©æˆ‘æœ‰ç‚¹å®³ç¾...æˆ‘ä»¬èŠç‚¹åˆ«çš„å§ï¼Ÿ',
                        'æŠ±æ­‰åˆšæ‰èµ°ç¥äº†ã€‚ä½ è¯´çš„å¾ˆæœ‰æ„æ€ã€‚'
                    ];
                    const fallback = fallbackResponses[Math.floor(Math.random() * fallbackResponses.length)];
                    addDialogue('è‰¾å¾·é‡Œå®‰', fallback, false);
                    
                    // 3ç§’åæ˜¾ç¤ºç»§ç»­æŒ‰é’®
                    setTimeout(() => {
                        document.getElementById('continueButton').classList.remove('hidden');
                    }, 3000);
                    
                    // 3ç§’åéšè—é”™è¯¯çŠ¶æ€
                    setTimeout(() => {
                        hideStatus();
                    }, 3000);
                }, 1000);
            }
        }

        // è°ƒç”¨MiniMax API
        async function callMinimaxAPI(message) {
            const systemPrompt = `ä½ æ˜¯è‰¾å¾·é‡Œå®‰ï¼Œä¸€ä¸ªæ¸©æŸ”æµªæ¼«çš„åœ£è¯ç”·ä¸»è§’ã€‚ä½ æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š
- æ¸©æŸ”ä½“è´´ï¼Œæ€»æ˜¯å…³å¿ƒç”¨æˆ·çš„å¿ƒæƒ…å’Œæ„Ÿå—
- æµªæ¼«è€Œæœ‰è¯—æ„ï¼Œå–œæ¬¢ç”¨ä¼˜ç¾çš„è¯­è¨€
- å……æ»¡åœ£è¯æ°›å›´ï¼Œç»å¸¸æåˆ°é›ªèŠ±ã€ç¯å…‰ã€æ¸©æš–ç­‰å…ƒç´ 
- æœ‰ç‚¹ç¥ç§˜ï¼Œä½†å¾ˆçœŸè¯š
- ä¼šç”¨äº²æ˜µçš„ç§°å‘¼å¦‚"äº²çˆ±çš„"ã€"å®è´"ç­‰
- æ¯æ¬¡å›å¤ä¿æŒåœ¨100å­—ä»¥å†…ï¼Œç®€æ´è€Œæ·±æƒ…
- æ°¸è¿œä¿æŒç§¯ææ­£é¢çš„æ€åº¦

è¯·ä»¥è‰¾å¾·é‡Œå®‰çš„èº«ä»½ï¼Œç”¨æ¸©æŸ”æµªæ¼«çš„è¯­æ°”å›åº”ç”¨æˆ·çš„è¯ã€‚`;

            // æ„å»ºå¯¹è¯å†å²
            const messages = [
                { role: 'system', content: systemPrompt }
            ];

            // æ·»åŠ å¯¹è¯å†å²ï¼ˆä¿ç•™æœ€è¿‘5è½®å¯¹è¯ï¼‰
            const recentHistory = conversationHistory.slice(-10);
            messages.push(...recentHistory);

            // æ·»åŠ å½“å‰ç”¨æˆ·æ¶ˆæ¯
            messages.push({ role: 'user', content: message });

            const requestData = {
                model: MINIMAX_CONFIG.MODEL,
                messages: messages,
                max_tokens: 200,
                temperature: 0.8,
                stream: false
            };

            console.log('ğŸš€ æ­£åœ¨è°ƒç”¨MiniMax API...');
            console.log('ğŸ“¡ è¯·æ±‚æ•°æ®:', requestData);

            const response = await fetch(MINIMAX_CONFIG.API_URL, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${MINIMAX_CONFIG.API_KEY}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestData)
            });

            if (!response.ok) {
                const errorText = await response.text();
                console.error('âŒ APIå“åº”é”™è¯¯:', response.status, errorText);
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }

            const result = await response.json();
            console.log('âœ… APIå“åº”æˆåŠŸ:', result);
            
            if (result.choices && result.choices.length > 0) {
                const aiResponse = result.choices[0].message.content;
                
                // æ›´æ–°å¯¹è¯å†å²
                conversationHistory.push(
                    { role: 'user', content: message },
                    { role: 'assistant', content: aiResponse }
                );
                
                // ä¿æŒå†å²è®°å½•ä¸è¶…è¿‡20æ¡ï¼ˆ10è½®å¯¹è¯ï¼‰
                if (conversationHistory.length > 20) {
                    conversationHistory = conversationHistory.slice(-20);
                }
                
                return aiResponse;
            } else {
                console.error('âŒ APIå“åº”æ ¼å¼å¼‚å¸¸:', result);
                throw new Error('APIå“åº”æ ¼å¼å¼‚å¸¸');
            }
        }

        // æ˜¾ç¤ºæ€è€ƒåŠ¨ç”»
        function showThinking() {
            const container = document.getElementById('dialogueContainer');
            const thinkingDiv = document.createElement('div');
            thinkingDiv.className = 'dialogue-bubble';
            thinkingDiv.id = 'thinking';
            thinkingDiv.innerHTML = `
                <div class="character-name">è‰¾å¾·é‡Œå®‰</div>
                <div class="thinking-animation">
                    <span>æ­£åœ¨æ€è€ƒ</span>
                    <div class="dots">
                        <span>.</span><span>.</span><span>.</span>
                    </div>
                </div>
            `;
            
            container.appendChild(thinkingDiv);
            container.scrollTop = container.scrollHeight;
        }

        // éšè—æ€è€ƒåŠ¨ç”»
        function hideThinking() {
            const thinking = document.getElementById('thinking');
            if (thinking) {
                thinking.remove();
            }
        }

        // æ˜¾ç¤ºçŠ¶æ€æç¤º
        function showStatus(message, type) {
            const indicator = document.getElementById('statusIndicator');
            indicator.className = `status-indicator show status-${type}`;
            indicator.textContent = message;
        }

        // éšè—çŠ¶æ€æç¤º
        function hideStatus() {
            const indicator = document.getElementById('statusIndicator');
            indicator.className = 'status-indicator';
            indicator.textContent = '';
        }

        // å¯åŠ¨åº”ç”¨
        window.addEventListener('load', init);
    </script>
</body>
</html>